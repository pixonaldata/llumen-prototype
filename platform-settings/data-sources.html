<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Sources - Platform Settings - Crimson</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="../styles.css">
    
    <style>
        /* Drag and Drop Styles */
        .draggable-row {
            cursor: move;
            transition: all 0.2s ease;
        }
        
        .draggable-row.dragging {
            opacity: 0.5;
        }
        
        .drop-zone {
            position: relative;
        }
        
        /* .drop-zone.drag-over {
            border-top: 2px solid #ef4444;
        } */
        
        .drop-zone.drag-over::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #ef4444;
        }
        
        .non-draggable {
            cursor: default;
        }
        
        .non-draggable:hover {
            background-color: transparent;
        }
        
        .drag-handle {
            cursor: move;
            color: #9ca3af;
            transition: color 0.2s ease;
        }
        
        .drag-handle:hover {
            color: #ef4444;
        }

        .key-value-row.readonly .drag-handle,
        .key-value-row.readonly .toggle-switch-container,
        .key-value-row.readonly .delete-button-container {
            display: none;
        }
    </style>
</head>
<body>
    <div id="crimson-app" class="bg-gray-900">
        <header class="bg-gray-800 py-4 px-4 md:px-8 flex items-center justify-between shadow-lg sticky top-0 z-30">
            <!-- Left-aligned group: Logo, divider, client logo, and navigation -->
            <div class="flex items-center">
                <div class="w-8 h-8 flex items-center justify-center rounded-md overflow-hidden">
                    <svg viewBox="0 0 32 32" class="w-full h-full">
                        <circle cx="16" cy="16" r="16" fill="#dc2626" /> <circle cx="16" cy="16" r="8" fill="#ffffff" /> </svg>
                </div>
                <div class="h-6 border-l border-gray-600 ml-4"></div>
                <div class="flex items-center justify-center px-3 py-1 rounded-md bg-[#1a1a1a] text-white text-sm font-semibold h-8 ml-4">
                    <span>Client Logo</span>
                </div>
                <nav class="flex items-center ml-4">
                    <a href="../index.html" class="px-3 py-2 rounded-md text-sm text-gray-400 hover:text-white transition duration-200">My Workspaces</a>
                    <a href="../explore.html" class="px-3 py-2 rounded-md text-sm text-gray-400 hover:text-white transition duration-200">Explore</a>
                </nav>
            </div>

            <!-- Right-aligned group of icons and user dropdown -->
            <div class="flex items-center">
                <!-- Search container -->
                <div id="search-container" class="relative flex items-center">
                    <button id="search-icon-button" class="text-gray-300 hover:text-red-400 p-2 rounded-full transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-red-500 z-10">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </button>
                    <div id="search-input-wrapper" class="absolute right-0 flex items-center bg-gray-700 rounded-full overflow-hidden transition-all duration-300 ease-in-out">
                        <svg class="w-5 h-5 text-gray-400 ml-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        <input type="text" id="header-search-input" placeholder="Search..." class="bg-transparent text-white pl-2 pr-4 py-2 w-full focus:outline-none placeholder-gray-400 text-sm">
                    </div>
                </div>

                <!-- Notification Icon Button -->
                <button class="text-gray-300 hover:text-red-400 p-2 rounded-full transition duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 ml-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                </button>
                
                <!-- User Dropdown -->
                <div class="relative ml-4">
                    <button id="user-dropdown-button" class="flex items-center text-gray-300 hover:text-red-400 transition duration-200 focus:outline-none">
                        <img src="https://placehold.co/32x32/555/fff?text=J" alt="User Avatar" class="rounded-full">
                    </button>
                    <div id="user-dropdown-menu" class="absolute right-0 mt-2 w-48 rounded-md shadow-lg hidden options-dropdown-menu">
                        <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Account Settings</a>
                        <a href="overview.html" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Platform Settings</a>
                        <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Help</a>
                        <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Logout</a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Layout with Sidebar and Content -->
        <div class="flex flex-1">
            <!-- Vertical Sidebar Navigation -->
            <aside class="w-56 bg-gray-800 border-r border-gray-700 sidebar-nav">
                <div class="px-4 py-5">
                    <h1 class="text-xl font-bold text-white mb-5">Platform Settings</h1>
                    
                    <!-- Navigation Menu -->
                    <nav class="space-y-3">
                        <a href="overview.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200 mb-0">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">admin_panel_settings</span>
                                Overview
                            </div>
                        </a>
                        
                        <a href="components.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">grid_view</span>
                                Components
                            </div>
                        </a>
                        
                        <a href="filters.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">filter_list</span>
                                Filters
                            </div>
                        </a>
                        
                        <a href="ai-models.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">auto_awesome</span>
                                AI Models
                            </div>
                        </a>

                        <a href="data-sources.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200 active">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">storage</span>
                                Data Sources
                            </div>
                        </a>
                        
                        <a href="workspaces.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">workspaces</span>
                                Workspaces
                            </div>
                        </a>
                        
                        <a href="users.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">group</span>
                                Users
                            </div>
                        </a>
                        
                        <a href="security.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">security</span>
                                Security
                            </div>
                        </a>
                        
                        <a href="reporting.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">analytics</span>
                                Reporting
                            </div>
                        </a>
                        
                        <a href="billing.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">receipt_long</span>
                                Billing
                            </div>
                        </a>
                        
                        <a href="theme.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">palette</span>
                                Theme
                            </div>
                        </a>
                            
                        <a href="organization.html" class="platform-nav-item w-full text-left px-4 py-2 text-sm text-gray-300 hover:text-white transition duration-200">
                            <div class="flex items-center">
                                <span class="material-symbols-outlined mr-3 text-lg">business</span>
                                Organization
                            </div>
                        </a>
                    </nav>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="flex-1 main-content-area">
                <!-- Organization Tab Content -->
                <div id="organization-content" class="tab-content" style="height: calc(100vh - 72px);">
                    <div class="flex w-full">
                        <!-- Main Content Area -->
                        <div class="flex-1 min-w-0 flex justify-center" style="margin-right: 256px;">
                            <div class="p-10 max-w-7xl w-full">
                                <h2 class="text-2xl font-bold text-white mb-5">Data Source Management</h2>
                                
                                <!-- Internal Tabs -->
                                <div class="border-b border-gray-700 mb-6">
                                    <nav class="flex space-x-6">
                                        <button class="internal-tab-item pb-2 px-1 border-b-2 border-red-500 text-white font-medium text-sm" data-internal-tab="databases">
                                            Databases
                                        </button>
                                        <button class="internal-tab-item pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-internal-tab="apis">
                                            APIs
                                        </button>
                                        <button class="internal-tab-item pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-internal-tab="data-flows">
                                            Data Flows
                                        </button>
                                    </nav>
                                </div>

                                <!-- Tab Content -->
                                <!-- Databases Tab Content -->
                                <div id="databases-tab-content" class="tab-content">
                                    <!-- Database Management Grid -->
                                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                                    <div class="px-6 py-4 border-b border-gray-700">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center">
                                                <button class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center" onclick="openCreateDatabaseModal()">
                                                    <span class="material-symbols-outlined mr-1" style="font-size: 20px;">add</span>
                                                    Create Connection
                                                </button>
                                            </div>
                                            <div class="flex items-center">
                                                <div class="relative">
                                                    <input type="text" id="databases-search-input" placeholder="Search database connections..." class="bg-gray-700 text-white rounded-md p-2 pl-3 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm" style="width: 300px; padding-right: 3rem;" />
                                                    <button id="databases-search-clear" type="button" class="absolute right-11 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200 focus:outline-none" style="display: none;" data-tooltip="Clear Search">
                                                        <span class="material-symbols-outlined" style="font-size: 24px;">close</span>
                                                    </button>
                                                    <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">search</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Filter Row -->
                                    <div class="px-6 py-4 border-b border-gray-700">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-4">
                                                <!-- Type Filter -->
                                                <div class="relative">
                                                    <button id="database-type-filter-btn" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center">
                                                        <span class="mr-1">Type</span>
                                                        <span class="material-symbols-outlined" style="font-size: 18px;">expand_more</span>
                                                        <span id="database-type-clear-btn" class="ml-2 text-red-400 hover:text-red-300 transition duration-200 hidden cursor-pointer flex items-center" title="Clear Type Filter">
                                                            <span class="material-symbols-outlined" style="font-size: 18px;">cancel</span>
                                                        </span>
                                                    </button>
                                                    <div id="database-type-filter-dropdown" class="absolute top-full left-0 mt-2 bg-gray-700 rounded-md shadow-lg hidden z-50 min-w-48">
                                                        <div class="p-2">
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="mysql" class="mr-2"> MySQL
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="postgresql" class="mr-2"> PostgreSQL
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="sqlserver" class="mr-2"> SQL Server
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="oracle" class="mr-2"> Oracle
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="sqlite" class="mr-2"> SQLite
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Status Filter -->
                                                <div class="relative">
                                                    <button id="database-status-filter-btn" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center">
                                                        <span class="mr-1">Status</span>
                                                        <span class="material-symbols-outlined" style="font-size: 18px;">expand_more</span>
                                                        <span id="database-status-clear-btn" class="ml-2 text-red-400 hover:text-red-300 transition duration-200 hidden cursor-pointer flex items-center" title="Clear Status Filter">
                                                            <span class="material-symbols-outlined" style="font-size: 18px;">cancel</span>
                                                        </span>
                                                    </button>
                                                    <div id="database-status-filter-dropdown" class="absolute top-full left-0 mt-2 bg-gray-700 rounded-md shadow-lg hidden z-50 min-w-48">
                                                        <div class="p-2">
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="Active" class="mr-2"> Active
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="Inactive" class="mr-2"> Inactive
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Clear All Filters Button -->
                                            <button id="clear-all-database-filters-btn" class="text-red-400 hover:text-red-300 transition duration-200 text-sm flex items-center hidden">
                                                <span class="material-symbols-outlined mr-1 text-sm">clear_all</span>
                                                Clear All Filters
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="overflow-x-auto">
                                        <table id="databases-table" class="w-full">
                                            <thead class="border-b border-gray-700">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap w-full">Database Connections</th>
                                                    <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap">Type</th>
                                                    <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap">Status</th>
                                                    <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap">Last Updated</th>
                                                    <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider w-1 whitespace-nowrap"></th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-gray-800 divide-y divide-gray-700">
                                                <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center">
                                                            <div>
                                                                <div class="text-sm font-medium text-white">Population Analytics</div>
                                                                <div class="mt-1 text-gray-400">
                                                                    <p class="text-sm">Population and geographic data analysis results</p>
                                                                    <p class="text-xs mt-1">population-analytics-db.company.com:3306 - population_analytics_db</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="text-sm text-gray-300">MySQL</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                        2 hours ago
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                        <div class="relative">
                                                            <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" onclick="event.stopPropagation(); toggleDropdown('database-dropdown-1')">
                                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                                            </button>
                                                              <div id="database-dropdown-1" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                                <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center">
                                                            <div>
                                                                <div class="text-sm font-medium text-white">Analytics PostgreSQL</div>
                                                                <div class="mt-1 text-gray-400">
                                                                    <p class="text-sm">Analytics and reporting database</p>
                                                                    <p class="text-xs mt-1">analytics-reporting-db.company.com:3306 - analytics_reporting_db</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="text-sm text-gray-300">PostgreSQL</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                        1 day ago
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                        <div class="relative">
                                                            <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" onclick="event.stopPropagation(); toggleDropdown('database-dropdown-2')">
                                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                                            </button>
                                                              <div id="database-dropdown-2" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                                <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center">
                                                            <div>
                                                                <div class="text-sm font-medium text-white">Data Warehouse</div>
                                                                <div class="mt-1 text-gray-400">
                                                                    <p class="text-sm">Data warehouse for business intelligence</p>
                                                                    <p class="text-xs mt-1">data-watehouse-db.company.com:3306 - data_watehouse_db</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="text-sm text-gray-300">SQL Server</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                        3 days ago
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                        <div class="relative">
                                                            <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" onclick="event.stopPropagation(); toggleDropdown('database-dropdown-3')">
                                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                                            </button>
                                                              <div id="database-dropdown-3" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                                <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center">
                                                            <div>
                                                                <div class="text-sm font-medium text-white">Finance Oracle</div>
                                                                <div class="mt-1 text-gray-400">
                                                                    <p class="text-sm">Financial data and transactions</p>
                                                                    <p class="text-xs mt-1">finance-oracle-db.company.com:3306 - finance_oracle_db</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="text-sm text-gray-300">Oracle</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                        1 week ago
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                        <div class="relative">
                                                            <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" onclick="event.stopPropagation(); toggleDropdown('database-dropdown-4')">
                                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                                            </button>
                                                              <div id="database-dropdown-4" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                                <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center">
                                                            <div>
                                                                <div class="text-sm font-medium text-white">Local Development</div>
                                                                <div class="mt-1 text-gray-400">
                                                                    <p class="text-sm">Local development database</p>
                                                                    <p class="text-xs mt-1">localhost - localdev_db</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="text-sm text-gray-300">SQLite</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-900 text-red-300">Inactive</span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                        2 weeks ago
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                        <div class="relative">
                                                            <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" onclick="event.stopPropagation(); toggleDropdown('database-dropdown-5')">
                                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                                            </button>
                                                              <div id="database-dropdown-5" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Activate</a>
                                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <!-- No matches found message -->
                                        <div id="no-database-matches-message" class="hidden px-6 py-8 text-center">
                                            <div class="text-gray-400 text-sm">No databases found matching your search criteria.</div>
                                        </div>
                                    </div>
                                </div>
                                </div>

                                <!-- APIs Tab Content -->
                                <div id="apis-tab-content" class="tab-content hidden">
                                    <!-- API Management Grid -->
                                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                                    <div class="px-6 py-4 border-b border-gray-700">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center">
                                                <button onclick="openCreateAPICollectionModal()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center">
                                                    <span class="material-symbols-outlined mr-1" style="font-size: 20px;">add</span>
                                                    Create Collection
                                                </button>
                                            </div>
                                            <div class="flex items-center">
                                                <div class="relative">
                                                    <input type="text" id="apis-search-input" placeholder="Search collections & requests..." class="bg-gray-700 text-white rounded-md p-2 pl-3 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm" style="width: 300px; padding-right: 3rem;" />
                                                    <button id="apis-search-clear" type="button" class="absolute right-11 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200 focus:outline-none" style="display: none;" data-tooltip="Clear Search">
                                                        <span class="material-symbols-outlined" style="font-size: 24px;">close</span>
                                                    </button>
                                                    <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">search</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Filter Row -->
                                    <div class="px-6 py-4 border-b border-gray-700">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-4">
                                                <!-- Authentication Type Filter -->
                                                <!-- <div class="relative">
                                                    <button id="api-auth-type-filter-btn" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center">
                                                        <span class="mr-1">Authentication Type</span>
                                                        <span class="material-symbols-outlined" style="font-size: 18px;">expand_more</span>
                                                        <span id="api-auth-type-clear-btn" class="ml-2 text-red-400 hover:text-red-300 transition duration-200 hidden cursor-pointer flex items-center" title="Clear Authentication Type Filter">
                                                            <span class="material-symbols-outlined" style="font-size: 18px;">cancel</span>
                                                        </span>
                                                    </button>
                                                    <div id="api-auth-type-filter-dropdown" class="absolute top-full left-0 mt-2 bg-gray-700 rounded-md shadow-lg hidden z-50 min-w-48">
                                                        <div class="p-2">
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="none" class="mr-2"> No Authentication
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="basic" class="mr-2"> Basic Authentication
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="apikey" class="mr-2"> API Key
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="bearer" class="mr-2"> Bearer Token
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="oauth2" class="mr-2"> OAuth 2.0
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div> -->
                                                
                                                <!-- Method Filter -->
                                                <div class="relative">
                                                    <button id="api-method-filter-btn" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center">
                                                        <span class="mr-1">Method</span>
                                                        <span class="material-symbols-outlined" style="font-size: 18px;">expand_more</span>
                                                        <span id="api-method-clear-btn" class="ml-2 text-red-400 hover:text-red-300 transition duration-200 hidden cursor-pointer flex items-center" title="Clear Method Filter">
                                                            <span class="material-symbols-outlined" style="font-size: 18px;">cancel</span>
                                                        </span>
                                                    </button>
                                                    <div id="api-method-filter-dropdown" class="absolute top-full left-0 mt-2 bg-gray-700 rounded-md shadow-lg hidden z-50 min-w-48">
                                                        <div class="p-2">
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="GET" class="mr-2"> GET
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="POST" class="mr-2"> POST
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="PUT" class="mr-2"> PUT
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="DELETE" class="mr-2"> DELETE
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="PATCH" class="mr-2"> PATCH
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Status Filter -->
                                                <div class="relative">
                                                    <button id="api-status-filter-btn" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-md transition duration-200 text-sm flex items-center">
                                                        <span class="mr-1">Status</span>
                                                        <span class="material-symbols-outlined" style="font-size: 18px;">expand_more</span>
                                                        <span id="api-status-clear-btn" class="ml-2 text-red-400 hover:text-red-300 transition duration-200 hidden cursor-pointer flex items-center" title="Clear Status Filter">
                                                            <span class="material-symbols-outlined" style="font-size: 18px;">cancel</span>
                                                        </span>
                                                    </button>
                                                    <div id="api-status-filter-dropdown" class="absolute top-full left-0 mt-2 bg-gray-700 rounded-md shadow-lg hidden z-50 min-w-48">
                                                        <div class="p-2">
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="active" class="mr-2"> Active
                                                            </label>
                                                            <label class="flex items-center px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded cursor-pointer">
                                                                <input type="checkbox" value="inactive" class="mr-2"> Inactive
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="flex items-center">
                                                <button id="api-clear-all-filters-btn" class="text-red-400 hover:text-red-300 transition duration-200 text-sm flex items-center hidden">
                                                    <span class="material-symbols-outlined mr-1 text-sm">clear_all</span>
                                                    Clear All Filters
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                        <!-- API Tree Table -->
                                        <div class="overflow-x-auto">
                                            <table id="apis-table" class="w-full">
                                                <thead class="border-b border-gray-700">
                                                    <tr>
                                                        <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap w-full">API Collections & Requests</th>
                                                        <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap">Method</th>
                                                        <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap">Status</th>
                                                        <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider whitespace-nowrap">Last Updated</th>
                                                        <th class="px-6 py-3 text-left text-sm font-medium text-gray-300 tracking-wider w-1 whitespace-nowrap"></th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-gray-800 divide-y divide-gray-700">
                                                    <!-- API Collection 1 -->
                                                    <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer api-collection-row" data-collection-id="1">
                                                        <td class="px-6 py-4 pl-0 whitespace-nowrap">
                                                            <div class="flex items-center">
                                                                <button class="expand-collection-btn p-1 pr-5 pl-5 text-gray-400 hover:text-white transition duration-200 h-16 flex items-center" data-collection="1">
                                                                    <span class="material-symbols-outlined text-xlg">chevron_right</span>
                                                                </button>
                                                                <div>
                                                                    <div class="text-sm font-medium text-white">Weather Services</div>
                                                                    <div class="mt-1 text-gray-400">
                                                                        <p class="text-sm">Real-time weather data and forecasts</p>
                                                                        <p class="text-xs mt-1">weather.secureclient.com</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="text-sm text-gray-300">-</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                            2 hours ago
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                            <div class="relative">
                                                                <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="api-collection-1">
                                                                    <span class="material-symbols-outlined text-lg">more_vert</span>
                                                                </button>
                                                                <div id="api-collection-1-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150" onclick="openCreateRequestModal(); document.getElementById('api-collection-1-dropdown').classList.add('hidden');">Add Request</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    
                                                    <!-- API Request 1.1 (nested under Collection 1) -->
                                                    <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer api-request-row hidden" data-collection="1" data-request-id="1.1">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="flex items-center">
                                                                <div class="w-10"></div>
                                                                <div class="h-10 w-10 rounded-md bg-gray-600 flex items-center justify-center mr-4">
                                                                    <span class="material-symbols-outlined" style="font-size: 20px;">api</span>
                                                                </div>
                                                                <div>
                                                                    <div class="text-sm font-medium text-white">Get Current Weather</div>
                                                                    <div class="mt-1 text-gray-400">
                                                                        <p class="text-sm">Retrieve current weather conditions</p>
                                                                        <p class="text-xs mt-1">/weather/current</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">GET</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                            1 hour ago
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                            <div class="relative">
                                                                <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="api-request-1.1">
                                                                    <span class="material-symbols-outlined text-lg">more_vert</span>
                                                                </button>
                                                                <div id="api-request-1.1-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    
                                                    <!-- API Request 1.2 (nested under Collection 1) -->
                                                    <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer api-request-row hidden" data-collection="1" data-request-id="1.2">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="flex items-center">
                                                                <div class="w-10"></div>
                                                                <div class="h-10 w-10 rounded-md bg-gray-600 flex items-center justify-center mr-4">
                                                                    <span class="material-symbols-outlined text-white" style="font-size: 20px;">api</span>
                                                                </div>
                                                                <div>
                                                                    <div class="text-sm font-medium text-white">Get Weather Forecast</div>
                                                                    <div class="mt-1 text-gray-400">
                                                                        <p class="text-sm">Get 7-day weather forecast for location</p>
                                                                        <p class="text-xs mt-1">/weather/forecast</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-900 text-blue-300">POST</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                            45 mins ago
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                            <div class="relative">
                                                                <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="api-request-1.2">
                                                                    <span class="material-symbols-outlined text-lg">more_vert</span>
                                                                </button>
                                                                <div id="api-request-1.2-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>

                                                    <!-- API Collection 2 -->
                                                    <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer api-collection-row" data-collection-id="2">
                                                        <td class="px-6 py-4 pl-0 whitespace-nowrap">
                                                            <div class="flex items-center">
                                                                <button class="expand-collection-btn p-1 pr-5 pl-5 text-gray-400 hover:text-white transition duration-200 h-16 flex items-center" data-collection="2">
                                                                    <span class="material-symbols-outlined text-xlg">chevron_right</span>
                                                                </button>
                                                                <div>
                                                                    <div class="text-sm font-medium text-white">Traffic Services</div>
                                                                    <div class="mt-1 text-gray-400">
                                                                        <p class="text-sm">Real-time traffic data and route optimization</p>
                                                                        <p class="text-xs mt-1">traffic.secureclient.com</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="text-sm text-gray-300">-</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                            1 day ago
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                            <div class="relative">
                                                                <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="api-collection-2">
                                                                    <span class="material-symbols-outlined text-lg">more_vert</span>
                                                                </button>
                                                                <div id="api-collection-2-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150" onclick="openCreateRequestModal(); document.getElementById('api-collection-2-dropdown').classList.add('hidden');">Add Request</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    
                                                    <!-- API Request 2.1 (nested under Collection 2) -->
                                                    <tr class="hover:bg-gray-700 transition duration-200 cursor-pointer api-request-row hidden" data-collection="2" data-request-id="2.1">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="flex items-center">
                                                                <div class="w-10"></div>
                                                                <div class="h-10 w-10 rounded-md bg-gray-600 flex items-center justify-center mr-4">
                                                                    <span class="material-symbols-outlined text-white" style="font-size: 20px;">api</span>
                                                                </div>
                                                                <div>
                                                                    <div class="text-sm font-medium text-white">Get Traffic Flow</div>
                                                                    <div class="mt-1 text-gray-400">
                                                                        <p class="text-sm">Retrieve real-time traffic flow data</p>
                                                                        <p class="text-xs mt-1">/traffic/flow</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-900 text-blue-300">POST</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                                                            3 hours ago
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                            <div class="relative">
                                                                <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="api-request-2.1">
                                                                    <span class="material-symbols-outlined text-lg">more_vert</span>
                                                                </button>
                                                                <div id="api-request-2.1-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                                    <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- No matches found message -->
                                        <div id="no-api-matches-message" class="hidden px-6 py-8 text-center">
                                            <div class="text-gray-400 text-sm">No API collections or requests found matching your search criteria.</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Data Flows Tab Content -->
                                <div id="data-flows-tab-content" class="tab-content hidden">
                                <div class="bg-gray-800 rounded-lg p-6">
                                        <h3 class="text-lg font-semibold text-white mb-4">Data Flows Management</h3>
                                        <p class="text-gray-400">Data flows management functionality will be implemented here.</p>
                                </div>
                                </div>

                                </div>

                                
                            </div>
                        </div>
                        
                        <!-- Right Column - Organization Statistics -->
                        <div class="w-64 bg-gray-800 border-l border-gray-700 h-full fixed right-0 top-0 overflow-y-auto" style="height: calc(100vh - 72px); margin-top: 72px;">
                            <div class="p-4">
                                <h3 class="text-md font-semibold text-white mb-4">Quick Stats</h3>
                                <div class="space-y-4">
                                    <!-- Domains -->
                                    <div class="bg-gray-700 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <div class="w-10 h-10 flex items-center justify-center bg-green-600 rounded-lg">
                                                <span class="material-symbols-outlined text-white text-xl">storage</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-gray-400">Databases</p>
                                                <p class="text-lg font-bold text-white">4</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Branding -->
                                    <div class="bg-gray-700 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <div class="w-10 h-10 flex items-center justify-center bg-blue-600 rounded-lg">
                                                <span class="material-symbols-outlined text-white text-xl">api</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-gray-400">APIs</p>
                                                <p class="text-lg font-bold text-white">15</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Data Flows -->
                                    <div class="bg-gray-700 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <div class="w-10 h-10 flex items-center justify-center bg-purple-600 rounded-lg">
                                                <span class="material-symbols-outlined text-white text-xl">account_tree</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-gray-400">Data Flows</p>
                                                <p class="text-lg font-bold text-white">3</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <!-- Unified API Details Modal -->
    <div id="api-details-modal" class="fixed inset-0 p-10 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1560px] flex flex-col">
            
            <!-- Modal Content -->
            <div class="flex flex-1 overflow-hidden">
                <!-- Left Column - Navigation Tabs -->
                <div class="w-72 bg-gray-800 border-r border-gray-700 flex flex-col">
                    <!-- Collection Tab -->
                      <div class="relative bg-gray-600 border-b border-gray-700 border-l-2 border-l-red-500 text-white">
                             <button id="collection-nav-tab" class="api-nav-tab w-full py-3 px-6 pr-14 text-left" data-api-nav="collection">
                                 <div class="flex items-center">
                                     <div>
                                         <div class="font-medium">Collection</div>
                                         <div class="text-xs text-gray-300">Weather Services</div>
                                         <span class="inline-flex px-2 py-0.5 font-medium rounded-full bg-green-900 text-green-300 mt-1" style="font-size: 10px;">Active</span>
                                     </div>
                                 </div>
                             </button>
                         <div class="absolute right-3 top-1/2 translate-y-[-50%] z-10">
                             <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="nav-collection-dropdown">
                                 <span class="material-symbols-outlined text-lg">more_vert</span>
                             </button>
                             <div id="nav-collection-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                 <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150" onclick="openCreateRequestModal(); document.getElementById('nav-collection-dropdown').classList.add('hidden');">Add Request</a>
                                 <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                 <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                 <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                             </div>
                         </div>
                      </div>
                    
                    <!-- Request Tabs -->
                    <div class="flex-1 overflow-y-auto">
                        <div class="relative border-b border-gray-700 border-l-2 border-l-transparent text-gray-400 hover:text-white hover:bg-gray-700">
                             <button id="request-nav-tab-1" class="api-nav-tab w-full py-3 px-6 pr-14 text-left" data-api-nav="request" data-request-id="1.1">
                                 <div class="flex items-center">
                                     <span class="material-symbols-outlined text-lg mr-3">api</span>
                                     <div>
                                         <div class="text-sm font-medium">Get Current Weather</div>
                                         <div class="text-xs">GET /weather/current</div>
                                         <span class="inline-flex px-2 py-0.5 font-medium rounded-full bg-green-900 text-green-300 mt-1" style="font-size: 10px;">Active</span>
                                     </div>
                                 </div>
                             </button>
                             <div class="absolute right-3 top-1/2 translate-y-[-50%] z-10">
                                 <div class="relative">
                                      <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="nav-request-1.1-dropdown">
                                         <span class="material-symbols-outlined text-lg">more_vert</span>
                                     </button>
                                     <div id="nav-request-1.1-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                         <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                         <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                         <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                     </div>
                                 </div>
                             </div>
                        </div>
                        <div class="relative border-b border-gray-700 border-l-2 border-l-transparent text-gray-400 hover:text-white hover:bg-gray-700">
                            <button id="request-nav-tab-2" class="api-nav-tab w-full py-3 px-6 pr-14 text-left" data-api-nav="request" data-request-id="1.2">
                                <div class="flex items-center">
                                    <span class="material-symbols-outlined text-lg mr-3">api</span>
                                    <div>
                                        <div class="text-sm font-medium">Get Weather Forecast</div>
                                        <div class="text-xs">GET /weather/forecast</div>
                                        <span class="inline-flex px-2 py-0.5 font-medium rounded-full bg-green-900 text-green-300 mt-1" style="font-size: 10px;">Active</span>
                                    </div>
                                </div>
                            </button>
                            <div class="absolute right-3 top-1/2 translate-y-[-50%] z-10">
                                <div class="relative">
                                     <button class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400" data-dropdown="nav-request-1.2-dropdown">
                                        <span class="material-symbols-outlined text-lg">more_vert</span>
                                    </button>
                                    <div id="nav-request-1.2-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                        <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Add Request Button -->
                    <div class="border-t border-gray-700 py-3 px-6">
                        <button onclick="openCreateRequestModal()" class="w-full flex items-center justify-center px-3 py-2.5 text-sm bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white rounded-md transition duration-200">
                            <span class="material-symbols-outlined mr-1" style="font-size: 20px;">add</span>
                            Add Request
                        </button>
                    </div>
                </div>
                
                <!-- Right Column - Content -->
                <div class="flex-1 flex flex-col">
                    <!-- Collection Content -->
                    <div id="collection-content" class="api-content-section flex flex-col h-full">
                        <!-- Fixed Content (Description, Metadata) -->
                        <div class="flex-shrink-0">
                            <!-- Collection Title and Edit Button -->
                            <div class="py-4 px-6">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <h2 class="text-xl font-semibold text-white mr-4">Weather Services</h2>
                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <button onclick="openEditCollectionModal()" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition duration-200 text-sm flex items-center">
                                            <span class="material-symbols-outlined mr-2" style="font-size: 18px;">edit</span>
                                            Edit Collection
                                        </button>
                                        <!-- Collection Dropdown -->
                                        <div class="relative">
                                            <button id="collection-actions-dropdown-btn" class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400">
                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                            </button>
                                            <div id="collection-actions-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150" onclick="openCreateRequestModal(); document.getElementById('collection-actions-dropdown').classList.add('hidden');">Add Request</a>
                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                            </div>
                                        </div>
                                        <!-- Close Button -->
                                        <button id="close-api-details-modal" class="text-gray-400 hover:text-white transition duration-200 flex items-center">
                                            <span class="material-symbols-outlined text-xl">close</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="border-b border-gray-700"></div>

                            <!-- Description -->
                            <div class="py-4 px-6">
                                <div class="text-sm">
                                    <div class="text-gray-500 mb-1">Description</div>
                                    <div class="text-gray-300">Real-time weather data and forecasts</div>
                                </div>
                            </div>
                            
                            <!-- Metadata -->
                            <div class="px-6 pb-4">
                                <div class="grid grid-cols-3 gap-4 text-sm">
                                    <div>
                                        <div class="text-gray-500 mb-1">Base URL</div>
                                        <div class="text-gray-300">weather.secureclient.com</div>
                                    </div>
                                    <div>
                                        <div class="text-gray-500 mb-1">Created</div>
                                        <div class="text-gray-300">May 15, 2024 <span class="text-gray-500">(John Doe)</span></div>
                                    </div>
                                    <div>
                                        <div class="text-gray-500 mb-1">Last Updated</div>
                                        <div class="text-gray-300">Aug 23, 2024 <span class="text-gray-500">(John Doe)</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
 
                        <!-- Collection Tabs -->
                        <div class="border-b border-gray-700 px-6 mt-2">
                            <nav class="flex space-x-6">
                                <button class="api-collection-tab pb-2 px-1 border-b-2 border-red-500 text-white font-medium text-sm" data-api-collection-tab="auth">
                                    Authentication
                                </button>
                                <button class="api-collection-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-api-collection-tab="script">
                                    Pre-Request Script
                                </button>
                                <button class="api-collection-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-api-collection-tab="variables">
                                    Variables
                                </button>
                            </nav>
                        </div>
                        
                        <!-- Collection Configuration Tabs -->
                        <div class="flex-1 overflow-y-auto p-6">
                             
                            <!-- Authentication Tab Content -->
                            <div id="api-collection-auth-content" class="api-collection-tab-content">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-300 mb-2">Type</label>
                                        <div class="relative">
                                            <select class="w-full bg-gray-800 rounded-md px-3 py-2 pr-8 text-sm text-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none opacity-100" disabled>
                                                <option value="none">No Authentication</option>
                                                <option value="basic">Basic Authentication</option>
                                                <option value="apikey" selected>API Key</option>
                                                <option value="bearer">Bearer Token</option>
                                                <option value="oauth2">OAuth 2.0</option>
                                            </select>
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none hidden">
                                                <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- API Key Configuration (default selected) -->
                                    <div id="apikey-config" class="space-y-3">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-300 mb-2">Key</label>
                                            <input type="text" value="X-API-Key" class="w-full bg-gray-800 rounded-md px-3 py-2 text-sm text-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500" disabled>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-300 mb-2">Value</label>
                                            <input type="password" value="your_api_key_here" class="w-full bg-gray-800 rounded-md px-3 py-2 text-sm text-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500" disabled>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-300 mb-2">Add to</label>
                                            <div class="relative">
                                                <select class="w-full bg-gray-800 rounded-md px-3 py-2 pr-8 text-sm text-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none opacity-100" disabled>
                                                    <option value="header" selected>Header</option>
                                                    <option value="query">Query Params</option>
                                                    <option value="auth">Authorization Header</option>
                                                </select>
                                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none hidden">
                                                    <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            
                            <!-- Pre-Request Script Tab Content -->
                            <div id="api-collection-script-content" class="api-collection-tab-content hidden">
                                <div class="space-y-3">
                                    <textarea 
                                        class="w-full h-64 bg-gray-800 rounded-md p-4 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm font-mono resize-none text-gray-400"
                                        placeholder="// Access to 'llumen' object available in Llumen sandbox environment&#10;// Example:&#10;// llumen.setVariable('timestamp', Date.now());&#10;// llumen.log('Pre-request script executed');"
                                        disabled
                                    >// Set dynamic timestamp
llumen.setVariable('timestamp', Date.now());
 
// Log execution
llumen.log('Pre-request script executed for Weather Services collection');</textarea>
                                </div>
                            </div>
                            
                            <!-- Variables Tab Content -->
                            <div id="api-collection-variables-content" class="api-collection-tab-content hidden">
                                <div class="space-y-2">
                                    <div class="flex items-center space-x-2 draggable-row drop-zone key-value-row readonly" data-index="0">
                                        <div class="w-9 h-8 flex items-center toggle-switch-container">
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <input type="text" placeholder="Key" value="base_url" class="flex-1 bg-gray-800 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-gray-400" disabled>
                                        <input type="text" placeholder="Value" value="weather.secureclient.com" class="flex-1 bg-gray-800 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-gray-400" disabled>
                                        <div class="w-8 h-8 flex items-center delete-button-container">
                                            <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                                <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2 draggable-row drop-zone key-value-row readonly" data-index="1">
                                        <div class="w-9 h-8 flex items-center toggle-switch-container">
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <input type="text" placeholder="Key" value="api_version" class="flex-1 bg-gray-800 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-gray-400" disabled>
                                        <input type="text" placeholder="Value" value="v1" class="flex-1 bg-gray-800 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-gray-400" disabled>
                                        <div class="w-8 h-8 flex items-center delete-button-container">
                                            <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                                <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2 non-draggable key-value-row readonly hidden" data-index="2">
                                        <div class="drag-handle w-6 h-8 flex items-center">
                                            <span class="material-symbols-outlined hidden" style="font-size: 20px;">drag_indicator</span>
                                        </div>
                                        <div class="w-9 h-8 flex items-center toggle-switch-container">
                                            <label class="toggle-switch hidden">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-gray-400" disabled>
                                        <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-gray-400" disabled>
                                        <div class="w-8 h-8 flex items-center delete-button-container">
                                            <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                                <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Request Content (Hidden by default) -->
                    <div id="request-content" class="api-content-section flex flex-col h-full hidden">
                        <!-- Fixed Content (Description, Metadata) -->
                        <div class="flex-shrink-0">
                            <!-- Request Title and Edit Button -->
                            <div class="py-4 px-6">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <h2 class="text-xl font-semibold text-white mr-4">Get Current Weather</h2>
                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <button onclick="openEditRequestModal()" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition duration-200 text-sm flex items-center">
                                            <span class="material-symbols-outlined mr-2" style="font-size: 18px;">edit</span>
                                            Edit Request
                                        </button>
                                        <!-- Request Dropdown -->
                                        <div class="relative">
                                            <button id="request-actions-dropdown-btn" class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400">
                                                <span class="material-symbols-outlined text-lg">more_vert</span>
                                            </button>
                                            <div id="request-actions-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                                            </div>
                                        </div>
                                        <!-- Close Button -->
                                        <button id="close-api-details-modal-request" class="text-gray-400 hover:text-white transition duration-200 flex items-center">
                                            <span class="material-symbols-outlined text-xl">close</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="border-b border-gray-700"></div>

                            <!-- Description -->
                            <div class="py-4 px-6">
                                <div class="text-sm">
                                    <div class="text-gray-500 mb-1">Description</div>
                                    <div class="text-gray-300">Retrieve current weather conditions</div>
                                </div>
                            </div>
                            
                            <!-- Metadata -->
                            <div class="px-6 pb-4">
                                <div class="grid grid-cols-4 gap-4 text-sm">
                                    <div>
                                        <div class="text-gray-500 mb-1">Method</div>
                                        <div class="text-gray-300">GET</div>
                                    </div>
                                    <div>
                                        <div class="text-gray-500 mb-1">Endpoint</div>
                                        <div class="text-gray-300">/weather/current</div>
                                    </div>
                                    <div>
                                        <div class="text-gray-500 mb-1">Created</div>
                                        <div class="text-gray-300">May 15, 2024 <span class="text-gray-500">(John Doe)</span></div>
                                    </div>
                                    <div>
                                        <div class="text-gray-500 mb-1">Last Updated</div>
                                        <div class="text-gray-300">Aug 23, 2024 <span class="text-gray-500">(John Doe)</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border-b border-gray-700 mb-4"></div>
 
                        <!-- Request Tabs -->
                        <div class="px-6">

                            <h3 class="font-medium text-gray-300 mb-4">Send Request</h3>

                            <nav class="flex space-x-6 border-b border-gray-700">
                                <button class="api-request-tab pb-2 px-1 border-b-2 border-red-500 text-white font-medium text-sm" data-api-request-tab="params">
                                    Parameters
                                </button>
                                <button class="api-request-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-api-request-tab="auth">
                                    Authentication
                                </button>
                                <button class="api-request-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-api-request-tab="headers">
                                    Headers
                                </button>
                                <button class="api-request-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-api-request-tab="body">
                                    Body
                                </button>
                                <button class="api-request-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-api-request-tab="script">
                                    Pre-Request Script
                                </button>
                            </nav>

                        </div>
                        
                        <!-- Request Configuration Tabs -->
                        <div class="flex-1 overflow-y-auto p-6">
                             
                            <!-- Parameters Tab Content -->
                            <div id="api-request-params-content" class="api-request-tab-content">
                                <div class="space-y-4">
                                    <!-- Query Params -->
                                    <div>
                                        <div class="flex items-center justify-between mb-2">
                                            <h3 class="text-sm font-medium text-gray-300">Query Params</h3>
                                        </div>
                                        <div class="space-y-2 border border-gray-700 p-3 rounded-md">
                                            <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="0" draggable="true">
                                                <div class="drag-handle w-6"></div>
                                                <div class="w-9"></div>
                                                <div class="flex-1 text-sm text-gray-500">Key</div>
                                                <div class="flex-1 text-sm text-gray-500">Value</div>
                                                <div class="w-8"> </div>
                                            </div>
                                            <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="0">
                                                <div class="w-9 h-8 flex items-center">
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" checked>
                                                        <span class="toggle-slider"></span>
                                                    </label>
                                                </div>
                                                <input type="text" placeholder="Key" value="location" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <input type="text" placeholder="Value" value="New York" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <div class="w-8 h-8 flex items-center">
                                                    <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                                        <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="1">
                                                <div class="w-9 h-8 flex items-center">
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" checked>
                                                        <span class="toggle-slider"></span>
                                                    </label>
                                                </div>
                                                <input type="text" placeholder="Key" value="units" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <input type="text" placeholder="Value" value="metric" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <div class="w-8 h-8 flex items-center">
                                                    <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                                        <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-2 non-draggable" data-index="2">
                                                <div class="drag-handle w-6 h-8 flex items-center">
                                                    <span class="material-symbols-outlined hidden" style="font-size: 20px;">drag_indicator</span>
                                                </div>
                                                <div class="w-9 h-8 flex items-center">
                                                    <label class="toggle-switch hidden">
                                                        <input type="checkbox" checked>
                                                        <span class="toggle-slider"></span>
                                                    </label>
                                                </div>
                                                <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <div class="w-8 h-8 flex items-center">
                                                    <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                                        <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Path Variables -->
                                    <div>
                                        <div class="flex items-center justify-between mb-2">
                                            <h3 class="text-sm font-medium text-gray-300">Path Variables</h3>
                                        </div>
                                        <div class="space-y-2 border border-gray-700 p-3 rounded-md">
                                            <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="0" draggable="true">
                                                <div class="flex-1 text-sm text-gray-500">Key</div>
                                                <div class="flex-1 text-sm text-gray-500">Value</div>
                                                <div class="w-8"> </div>
                                            </div>
                                            <div class="flex items-center space-x-2">
                                                <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                                <div class="w-8 h-8 flex items-center">
                                                    <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                                        <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Authentication Tab Content -->
                            <div id="api-request-auth-content" class="api-request-tab-content hidden">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-300 mb-2">Type</label>
                                        <div class="relative">
                                            <select class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                                <option value="inherit" selected>Inherit from Collection</option>
                                                <option value="none">No Authentication</option>
                                                <option value="basic">Basic Authentication</option>
                                                <option value="apikey">API Key</option>
                                                <option value="bearer">Bearer Token</option>
                                                <option value="oauth2">OAuth 2.0</option>
                                            </select>
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-sm text-gray-400">
                                        Currently inheriting API Key authentication from Weather Services collection.
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Headers Tab Content -->
                            <div id="api-request-headers-content" class="api-request-tab-content hidden">
                                <div class="space-y-2">
                                    <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="0">
                                        <div class="w-9 h-8 flex items-center">
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <input type="text" placeholder="Key" value="User-Agent" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                        <input type="text" placeholder="Value" value="Llumen-API-Client/1.0" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                        <div class="w-8 h-8 flex items-center">
                                            <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                                <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2 non-draggable" data-index="1">
                                        <div class="drag-handle w-6 h-8 flex items-center">
                                            <span class="material-symbols-outlined hidden" style="font-size: 20px;">drag_indicator</span>
                                        </div>
                                        <div class="w-9 h-8 flex items-center">
                                            <label class="toggle-switch hidden">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                        <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                        <div class="w-8 h-8 flex items-center">
                                            <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                                <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Body Tab Content -->
                            <div id="api-request-body-content" class="api-request-tab-content hidden">
                                <div class="space-y-4">
                                    <div>
                                        <div class="relative inline-flex">
                                            <select class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                                <option value="none">None</option>
                                                <option value="form-data" selected>Form Data</option>
                                                <option value="x-www-form-urlencoded">x-www-form-urlencoded</option>
                                                <option value="raw">Raw</option>
                                                <option value="binary">Binary</option>
                                            </select>
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="space-y-2">
                                        <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="0">
                                            <div class="w-9 h-8 flex items-center">
                                                <label class="toggle-switch">
                                                    <input type="checkbox" checked>
                                                    <span class="toggle-slider"></span>
                                                </label>
                                            </div>
                                            <input type="text" placeholder="Key" value="location" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                            <div class="relative">
                                                <select class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-12 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                                    <option value="text" selected>Text</option>
                                                    <option value="file" >File</option>
                                                </select>
                                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                    <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                                </div>
                                            </div>
                                            <input type="text" placeholder="Value" value="New York" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                            <div class="w-8 h-8 flex items-center">
                                                <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                                    <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 non-draggable" data-index="1">
                                            <div class="drag-handle w-6 h-8 flex items-center">
                                                <span class="material-symbols-outlined hidden" style="font-size: 20px;">drag_indicator</span>
                                            </div>
                                            <div class="w-9 h-8 flex items-center">
                                                <label class="toggle-switch hidden">
                                                    <input type="checkbox" checked>
                                                    <span class="toggle-slider"></span>
                                                </label>
                                            </div>
                                            <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                            <div class="relative">
                                                <select class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-12 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                                    <option value="text" selected>Text</option>
                                                    <option value="file" >File</option>
                                                </select>
                                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                    <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                                </div>
                                            </div>
                                            <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                            <div class="w-8 h-8 flex items-center">
                                                <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                                    <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Pre-Request Script Tab Content -->
                            <div id="api-request-script-content" class="api-request-tab-content hidden">
                                <div class="space-y-3">
                                    <textarea 
                                        class="w-full h-64 bg-gray-800 border border-gray-600 rounded-md p-4 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm font-mono resize-none"
                                        placeholder="// Access to 'llumen' object available in Llumen sandbox environment&#10;// Example:&#10;// llumen.setVariable('timestamp', Date.now());&#10;// llumen.log('Pre-request script executed');"
                                    >// Set dynamic location based on user input
llumen.setVariable('location', 'New York');
 
// Log request details
llumen.log('Making weather request for: ' + llumen.getVariable('location'));</textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Response Section -->
                        <div class="border-t border-gray-700 p-6 h-[40%]">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="font-medium text-gray-300">Response</h3>
                                
                                <!-- Response Metadata -->
                                <div class="flex items-center space-x-6 text-xs">
                                    <div class="flex items-center space-x-1">
                                        <span class="text-gray-500">Status:</span>
                                        <span class="text-green-400 font-medium">200 OK</span>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <span class="text-gray-500">Time:</span>
                                        <span class="text-gray-300">245ms</span>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <span class="text-gray-500">Size:</span>
                                        <span class="text-gray-300">1.2 KB</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Response Body -->
                            <div class="bg-gray-800 border border-gray-600 rounded-md p-4">
                                <pre class="text-sm text-gray-300 overflow-x-auto"><code>{
  "location": "New York",
  "temperature": 22.5,
  "humidity": 65,
  "description": "Partly cloudy",
  "wind_speed": 12.3,
  "timestamp": "2024-01-15T14:30:00Z"
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        // Global functions for database modal
        function handleConfirmButtonClick(event) {
            event.preventDefault();
            
            // Get form values
            const name = document.getElementById('new-database-name').value;
            const type = document.getElementById('new-database-type').value;
            const host = document.getElementById('new-database-host').value;
            const port = document.getElementById('new-database-port').value;
            const dbname = document.getElementById('new-database-dbname').value;
            const username = document.getElementById('new-database-username').value;
            const password = document.getElementById('new-database-password').value;

            if (name && type && host && port && dbname && username && password) {
                const button = event.target;
                const buttonText = button.textContent.trim();
                
                if (buttonText === 'Test Connection') {
                    // Test connection logic
                    testDatabaseConnection(type, host, port, dbname, username);
                } else if (buttonText === 'Create Connection') {
                    // Create new database connection
                    const newDb = {
                        id: `db-${Date.now()}`,
                        name: name,
                        type: type,
                        host: host,
                        port: port,
                        dbname: dbname,
                        username: username,
                        description: `${type} database at ${host}:${port}`
                    };

                    // Add to databases array (this would be connected to your actual data management)
                    // For now, we'll just close the modal
                    
                    // Close modal
                    closeCreateDatabaseModalFunction();
                    
                    // Open Database Connection details modal
                    openDatabaseDetailsModal();
                    
                    // You could add the new database to the table here
                    // addDatabaseToTable(newDb);
                }
            } else {
                alert('Please fill in all required fields.');
            }
        }

        function testDatabaseConnection(type, host, port, dbname, username) {
            const confirmButton = document.getElementById('confirm-create-database');
            const testResultsArea = document.getElementById('test-results-area');
            
            // Show loading state with spinner
            confirmButton.innerHTML = `
                <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"></circle>
                    <path class="opacity-75" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M12 2a10 10 0 0 1 10 10"></path>
                </svg>
                Testing...
            `;
            confirmButton.disabled = true;
            confirmButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            confirmButton.classList.add('bg-gray-500', 'opacity-75', 'cursor-not-allowed');
            
            // Simulate connection test (replace with actual API call)
            setTimeout(() => {
                // Update test results based on database type
                updateTestResults(type);
                
                // Show test results
                testResultsArea.classList.remove('hidden');
                
                // Scroll to bottom with animation to show results
                setTimeout(() => {
                    const modalContent = document.getElementById('create-database-modal-content');
                    if (modalContent) {
                        modalContent.scrollTo({
                            top: modalContent.scrollHeight,
                            behavior: 'smooth'
                        });
                    }
                }, 100); // Small delay to ensure results are rendered
                
                // Update button to "Create Connection"
                confirmButton.innerHTML = 'Create Connection';
                confirmButton.disabled = false;
                confirmButton.classList.remove('bg-gray-500', 'opacity-75', 'cursor-not-allowed');
                confirmButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
            }, 2000); // Simulate 2 second test
        }

        function updateTestResults(type) {
            const dbVersionElement = document.getElementById('db-version');
            const tablesCountElement = document.getElementById('tables-count');
            
            // Update results based on database type
            const versionMap = {
                'mysql': 'MySQL 8.0.33',
                'postgresql': 'PostgreSQL 15.3',
                'sqlserver': 'SQL Server 2022',
                'oracle': 'Oracle Database 19c',
                'sqlite': 'SQLite 3.42.0'
            };
            
            const tablesMap = {
                'mysql': '12 tables',
                'postgresql': '8 tables',
                'sqlserver': '15 tables',
                'oracle': '6 tables',
                'sqlite': '3 tables'
            };
            
            if (dbVersionElement) {
                dbVersionElement.textContent = versionMap[type] || 'Unknown';
            }
            
            if (tablesCountElement) {
                tablesCountElement.textContent = tablesMap[type] || '0 tables';
            }
        }

        function closeCreateDatabaseModalFunction() {
            const createDatabaseModal = document.getElementById('create-database-modal');
            if (createDatabaseModal) {
                createDatabaseModal.classList.add('hidden');
                document.body.style.overflow = '';
                
                // Clear form fields
                clearCreateDatabaseForm();
            }
        }

        function clearCreateDatabaseForm() {
            const formFields = [
                'new-database-name',
                'new-database-type',
                'new-database-host',
                'new-database-port',
                'new-database-dbname',
                'new-database-username',
                'new-database-password'
            ];
            
            formFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.value = '';
                }
            });
            
            // Reset button state and hide test results
            const confirmButton = document.getElementById('confirm-create-database');
            const testResultsArea = document.getElementById('test-results-area');
            
            if (confirmButton) {
                confirmButton.innerHTML = 'Test Connection';
                confirmButton.disabled = false;
                confirmButton.classList.remove('bg-green-600', 'hover:bg-green-700');
                confirmButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
            }
            
            if (testResultsArea) {
                testResultsArea.classList.add('hidden');
            }
        }

        // Drag and Drop functionality for key/value pairs
        function initializeDragAndDrop(containerSelector) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            
            const rows = container.querySelectorAll('.draggable-row');
            
            rows.forEach(row => {
                // Check if drag handle already exists
                if (row.querySelector('.drag-handle')) {
                    return; // Skip this row if it already has a drag handle
                }
                
                // Add drag handle
                const dragHandle = document.createElement('div');
                dragHandle.className = 'drag-handle w-6 h-8 flex items-center';
                dragHandle.innerHTML = '<span class="material-symbols-outlined" style="font-size: 20px;">drag_indicator</span>';
                
                // Insert drag handle as the first element inside the draggable-row div
                row.insertBefore(dragHandle, row.firstElementChild);
                
                // Make row draggable
                row.draggable = true;
                
                // Drag start
                row.addEventListener('dragstart', (e) => {
                    row.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/html', row.outerHTML);
                    e.dataTransfer.setData('text/plain', row.dataset.index || '');
                });
                
                // Drag end
                row.addEventListener('dragend', (e) => {
                    row.classList.remove('dragging');
                    // Remove all drag-over classes
                    container.querySelectorAll('.drop-zone').forEach(zone => {
                        zone.classList.remove('drag-over');
                    });
                });
                
                // Drag over
                row.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                    
                    // Don't allow dropping on the last empty row
                    if (row.classList.contains('non-draggable')) {
                        return;
                    }
                    
                    row.classList.add('drag-over');
                });
                
                // Drag leave
                row.addEventListener('dragleave', (e) => {
                    row.classList.remove('drag-over');
                });
                
                // Drop
                row.addEventListener('drop', (e) => {
                    e.preventDefault();
                    row.classList.remove('drag-over');
                    
                    // Don't allow dropping on the last empty row
                    if (row.classList.contains('non-draggable')) {
                        return;
                    }
                    
                    const draggedRow = container.querySelector('.dragging');
                    if (draggedRow && draggedRow !== row) {
                        // Get the current index of the dragged row and target row
                        const draggedIndex = parseInt(draggedRow.dataset.index);
                        const targetIndex = parseInt(row.dataset.index);
                        
                        // Remove the dragged row from its current position
                        draggedRow.remove();
                        
                        // Insert the dragged row at the correct position
                        if (draggedIndex < targetIndex) {
                            // Dragging down: insert after the target row
                            row.parentNode.insertBefore(draggedRow, row.nextSibling);
                        } else {
                            // Dragging up: insert before the target row
                            row.parentNode.insertBefore(draggedRow, row);
                        }
                        
                        // Update indices
                        updateRowIndices(container);
                    }
                });
            });
        }
        
        function updateRowIndices(container) {
            const rows = container.querySelectorAll('.draggable-row');
            rows.forEach((row, index) => {
                row.dataset.index = index;
            });
        }
        
        function initializeAllDragAndDrop() {
            // Initialize drag and drop for all key/value pair containers
            initializeDragAndDrop('#api-collection-variables-content .space-y-2');
            initializeDragAndDrop('#api-request-params-content .space-y-2');
            initializeDragAndDrop('#api-request-headers-content .space-y-2');
            initializeDragAndDrop('#api-request-body-content .space-y-2');
        }

        // Global functions for API modals
        function openAPICollectionModal(collectionId) {
            const apiModal = document.getElementById('api-details-modal');
            if (apiModal) {
                apiModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Set modal title to collection name
                const modalTitle = document.getElementById('api-modal-title');
                if (modalTitle) {
                    modalTitle.textContent = 'Weather Services'; // This should be dynamic based on collectionId
                }
                
                // Show collection content and activate collection tab
                showCollectionContent();
                
                // Set up close button event listener when modal opens
                const closeApiModal = document.getElementById('close-api-details-modal');
                if (closeApiModal) {
                    // Remove any existing event listener to avoid duplicates
                    closeApiModal.removeEventListener('click', closeApiModalFunction);
                    closeApiModal.addEventListener('click', closeApiModalFunction);
                }
                
                // Set up Request close button event listener when modal opens
                const closeApiModalRequest = document.getElementById('close-api-details-modal-request');
                if (closeApiModalRequest) {
                    // Remove any existing event listener to avoid duplicates
                    closeApiModalRequest.removeEventListener('click', closeApiModalFunction);
                    closeApiModalRequest.addEventListener('click', closeApiModalFunction);
                }
                
                // Set up outside click handler when modal opens
                const handleOutsideClick = (event) => {
                    if (event.target === apiModal) {
                        closeApiModalFunction();
                        apiModal.removeEventListener('click', handleOutsideClick);
                    }
                };
                apiModal.addEventListener('click', handleOutsideClick);
                
                // Initialize navigation tabs
                initializeApiNavigationTabs();
                
                // Initialize collection and request tabs
                initializeApiCollectionTabs();
                initializeApiRequestTabs();
                
                // Initialize drag and drop functionality
                setTimeout(() => {
                    initializeAllDragAndDrop();
                }, 100);
            }
        }

        function openAPIRequestModal(requestId) {
            const apiModal = document.getElementById('api-details-modal');
            if (apiModal) {
                apiModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Set modal title to Weather Services (this modal is always for Weather Services)
                const modalTitle = document.getElementById('api-modal-title');
                if (modalTitle) {
                    modalTitle.textContent = 'Weather Services';
                }
                
                // Show the clicked request content, but only if it's a Weather Services request
                // For non-Weather requests (like Traffic), show the first Weather request
                if (requestId.startsWith('1.')) {
                    showRequestContent(requestId);
                } else {
                    showRequestContent('1.1'); // Default to first Weather request for non-Weather requests
                }
                
                // Set up close button event listener when modal opens
                const closeApiModal = document.getElementById('close-api-details-modal');
                if (closeApiModal) {
                    // Remove any existing event listener to avoid duplicates
                    closeApiModal.removeEventListener('click', closeApiModalFunction);
                    closeApiModal.addEventListener('click', closeApiModalFunction);
                }
                
                // Set up Request close button event listener when modal opens
                const closeApiModalRequest = document.getElementById('close-api-details-modal-request');
                if (closeApiModalRequest) {
                    // Remove any existing event listener to avoid duplicates
                    closeApiModalRequest.removeEventListener('click', closeApiModalFunction);
                    closeApiModalRequest.addEventListener('click', closeApiModalFunction);
                }
                
                // Set up outside click handler when modal opens
                const handleOutsideClick = (event) => {
                    if (event.target === apiModal) {
                        closeApiModalFunction();
                        apiModal.removeEventListener('click', handleOutsideClick);
                    }
                };
                apiModal.addEventListener('click', handleOutsideClick);
                
                // Initialize navigation tabs
                initializeApiNavigationTabs();
                
                // Initialize collection and request tabs
                initializeApiCollectionTabs();
                initializeApiRequestTabs();
                
                // Initialize drag and drop functionality
                setTimeout(() => {
                    initializeAllDragAndDrop();
                }, 100);
            }
        }

        // Additional global functions for API modals
        function closeApiModalFunction() {
            const apiModal = document.getElementById('api-details-modal');
            if (apiModal) {
                apiModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function showCollectionContent() {
            const collectionContent = document.getElementById('collection-content');
            const requestContent = document.getElementById('request-content');
            const collectionNavTab = document.getElementById('collection-nav-tab');
            const requestNavTabs = document.querySelectorAll('[data-api-nav="request"]');
            
            if (collectionContent) collectionContent.classList.remove('hidden');
            if (requestContent) requestContent.classList.add('hidden');
            
            // Update navigation tab states - now working with parent divs
            if (collectionNavTab) {
                const collectionDiv = collectionNavTab.closest('.relative');
                if (collectionDiv) {
                    collectionDiv.classList.remove('text-gray-400', 'hover:text-white', 'hover:bg-gray-700', 'border-l-transparent');
                    collectionDiv.classList.add('bg-gray-600', 'border-l-red-500', 'text-white');
                }
            }
            
            requestNavTabs.forEach(tab => {
                const requestDiv = tab.closest('.relative');
                if (requestDiv) {
                    requestDiv.classList.remove('bg-gray-600', 'border-l-red-500', 'text-white');
                    requestDiv.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-gray-700', 'border-l-transparent');
                }
            });
        }

        function showRequestContent(requestId) {
            const collectionContent = document.getElementById('collection-content');
            const requestContent = document.getElementById('request-content');
            const collectionNavTab = document.getElementById('collection-nav-tab');
            const requestNavTabs = document.querySelectorAll('[data-api-nav="request"]');
            
            if (collectionContent) collectionContent.classList.add('hidden');
            if (requestContent) requestContent.classList.remove('hidden');
            
            // Update navigation tab states - first deactivate all tabs (now working with parent divs)
            if (collectionNavTab) {
                const collectionDiv = collectionNavTab.closest('.relative');
                if (collectionDiv) {
                    collectionDiv.classList.remove('bg-gray-600', 'border-l-red-500', 'text-white');
                    collectionDiv.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-gray-700', 'border-l-transparent');
                }
            }
            
            // Deactivate all request tabs first
            requestNavTabs.forEach(tab => {
                const requestDiv = tab.closest('.relative');
                if (requestDiv) {
                    requestDiv.classList.remove('bg-gray-600', 'border-l-red-500', 'text-white');
                    requestDiv.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-gray-700', 'border-l-transparent');
                }
            });
            
            // Then activate the specific request tab
            const targetRequestTab = document.querySelector(`[data-api-nav="request"][data-request-id="${requestId}"]`);
            if (targetRequestTab) {
                const targetRequestDiv = targetRequestTab.closest('.relative');
                if (targetRequestDiv) {
                    targetRequestDiv.classList.remove('text-gray-400', 'hover:text-white', 'hover:bg-gray-700', 'border-l-transparent');
                    targetRequestDiv.classList.add('bg-gray-600', 'border-l-red-500', 'text-white');
                }
            }
        }

        // Flags to prevent duplicate event listeners
        let navigationTabsInitialized = false;
        let collectionTabsInitialized = false;
        let requestTabsInitialized = false;

        function initializeApiNavigationTabs() {
            // Prevent duplicate initialization
            if (navigationTabsInitialized) {
                return;
            }
            
            const navTabs = document.querySelectorAll('.api-nav-tab');
            
            navTabs.forEach((tab) => {
                tab.addEventListener('click', (event) => {
                    // Don't switch tabs if clicking on dropdown button
                    if (event.target.closest('.options-dropdown-button')) {
                        return;
                    }
                    
                    const navType = tab.getAttribute('data-api-nav');
                    const requestId = tab.getAttribute('data-request-id');
                    
                    if (navType === 'collection') {
                        showCollectionContent();
                    } else if (navType === 'request') {
                        showRequestContent(requestId);
                    }
                });
            });
            
            // Add event listeners to dropdown buttons
            const dropdownButtons = document.querySelectorAll('.options-dropdown-button[data-dropdown^="nav-"]');
            
            dropdownButtons.forEach((button) => {
                button.addEventListener('click', (event) => {
                    const dropdownId = button.getAttribute('data-dropdown');
                    event.stopPropagation();
                    toggleDropdown(dropdownId);
                });
            });
            
            navigationTabsInitialized = true;
        }

        function initializeApiCollectionTabs() {
            // Prevent duplicate initialization
            if (collectionTabsInitialized) {
                return;
            }
            
            const apiCollectionTabs = document.querySelectorAll('.api-collection-tab');
            const apiCollectionTabContents = document.querySelectorAll('.api-collection-tab-content');
            
            // Show the first tab content by default
            if (apiCollectionTabContents.length > 0) {
                apiCollectionTabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                apiCollectionTabContents[0].classList.remove('hidden');
            }
            
            // Set the first tab as active by default
            if (apiCollectionTabs.length > 0) {
                apiCollectionTabs.forEach(t => {
                    t.classList.remove('border-red-500', 'text-white');
                    t.classList.add('border-transparent', 'text-gray-400');
                });
                apiCollectionTabs[0].classList.remove('border-transparent', 'text-gray-400');
                apiCollectionTabs[0].classList.add('border-red-500', 'text-white');
            }
            
            apiCollectionTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetApiCollectionTab = tab.getAttribute('data-api-collection-tab');
                    
                    // Reset all API collection tabs to inactive state
                    apiCollectionTabs.forEach(t => {
                        t.classList.remove('border-red-500', 'text-white');
                        t.classList.add('border-transparent', 'text-gray-400');
                    });
                    
                    // Set clicked tab to active state
                    tab.classList.remove('border-transparent', 'text-gray-400');
                    tab.classList.add('border-red-500', 'text-white');
                    
                    // Hide all API collection tab contents
                    apiCollectionTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Show target API collection tab content
                    const targetContent = document.getElementById(`api-collection-${targetApiCollectionTab}-content`);
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
            
            collectionTabsInitialized = true;
        }

        function initializeApiRequestTabs() {
            // Prevent duplicate initialization
            if (requestTabsInitialized) {
                return;
            }
            
            const apiRequestTabs = document.querySelectorAll('.api-request-tab');
            const apiRequestTabContents = document.querySelectorAll('.api-request-tab-content');
            
            // Show the first tab content by default
            if (apiRequestTabContents.length > 0) {
                apiRequestTabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                apiRequestTabContents[0].classList.remove('hidden');
            }
            
            // Set the first tab as active by default
            if (apiRequestTabs.length > 0) {
                apiRequestTabs.forEach(t => {
                    t.classList.remove('border-red-500', 'text-white');
                    t.classList.add('border-transparent', 'text-gray-400');
                });
                apiRequestTabs[0].classList.remove('border-transparent', 'text-gray-400');
                apiRequestTabs[0].classList.add('border-red-500', 'text-white');
            }
            
            apiRequestTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetApiRequestTab = tab.getAttribute('data-api-request-tab');
                    
                    // Reset all API request tabs to inactive state
                    apiRequestTabs.forEach(t => {
                        t.classList.remove('border-red-500', 'text-white');
                        t.classList.add('border-transparent', 'text-gray-400');
                    });
                    
                    // Set clicked tab to active state
                    tab.classList.remove('border-transparent', 'text-gray-400');
                    tab.classList.add('border-red-500', 'text-white');
                    
                    // Hide all API request tab contents
                    apiRequestTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Show target API request tab content
                    const targetContent = document.getElementById(`api-request-${targetApiRequestTab}-content`);
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
            
            requestTabsInitialized = true;
        }

        // Global function for opening Create Database Modal
        function openCreateDatabaseModal() {
            const createDatabaseModal = document.getElementById('create-database-modal');
            if (createDatabaseModal) {
                createDatabaseModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Modal is now open and ready for interaction
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            
            // Initialize action dropdowns
            initializeActionDropdowns();

            // Search functionality
            const searchIconButton = document.getElementById('search-icon-button');
            const searchInputWrapper = document.getElementById('search-input-wrapper');
            const headerSearchInput = document.getElementById('header-search-input');

            searchIconButton.addEventListener('click', () => {
                searchInputWrapper.classList.toggle('is-active');
                if (searchInputWrapper.classList.contains('is-active')) {
                    headerSearchInput.focus();
                }
            });

            // User dropdown functionality
            const userDropdownButton = document.getElementById('user-dropdown-button');
            const userDropdownMenu = document.getElementById('user-dropdown-menu');

            userDropdownButton.addEventListener('click', (event) => {
                event.stopPropagation();
                userDropdownMenu.classList.toggle('hidden');
            });

            document.addEventListener('click', (event) => {
                if (!userDropdownButton.contains(event.target) && !userDropdownMenu.contains(event.target)) {
                    userDropdownMenu.classList.add('hidden');
                }
            });

            // Close search when clicking outside
            document.addEventListener('click', (event) => {
                if (!searchIconButton.contains(event.target) && !searchInputWrapper.contains(event.target)) {
                    searchInputWrapper.classList.remove('is-active');
                }
            });

            // Internal tab switching functionality
            document.querySelectorAll('.internal-tab-item').forEach(button => {
                button.addEventListener('click', function() {
                    // Skip if this is a modal tab
                    if (this.closest('#component-modal')) {
                        return;
                    }
                    
                    const tabContainer = this.closest('.tab-content');
                    const tabButtons = tabContainer.querySelectorAll('.internal-tab-item');
                    const tabId = this.getAttribute('data-internal-tab');
                    
                    // Remove active class from all internal tabs in this container
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active');
                        btn.classList.remove('border-red-500');
                        btn.classList.add('border-transparent');
                        btn.classList.remove('text-white');
                        btn.classList.add('text-gray-400');
                    });
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    this.classList.add('border-red-500');
                    this.classList.remove('border-transparent');
                    this.classList.add('text-white');
                    this.classList.remove('text-gray-400');
                    
                    // Show/hide tab content - only target the specific data source tab contents
                    const dataSourceTabContents = document.querySelectorAll('#databases-tab-content, #apis-tab-content, #data-flows-tab-content');
                    dataSourceTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Show the selected tab content
                    const selectedTabContent = document.getElementById(tabId + '-tab-content');
                    if (selectedTabContent) {
                        selectedTabContent.classList.remove('hidden');
                    }
                });
            });

            // Close dropdowns when clicking outside
            document.addEventListener('click', (event) => {
                if (!event.target.closest('[id^="dropdown-"]') && !event.target.closest('button[onclick*="toggleDropdown"]')) {
                    document.querySelectorAll('[id^="dropdown-"]').forEach(dropdown => {
                        dropdown.classList.add('hidden');
                    });
                }
            });

            // Close database dropdowns when clicking outside
            document.addEventListener('click', (event) => {
                if (!event.target.closest('[id^="database-dropdown-"]') && !event.target.closest('button[onclick*="toggleDropdown"]') && !event.target.closest('a[onclick*="openDatabaseModal"]')) {
                    document.querySelectorAll('[id^="database-dropdown-"]').forEach(dropdown => {
                        dropdown.classList.add('hidden');
                    });
                }
            });

            // Database search functionality
            const databasesSearchInput = document.getElementById('databases-search-input');
            const databasesSearchClear = document.getElementById('databases-search-clear');
            
            if (databasesSearchInput && databasesSearchClear) {
                databasesSearchInput.addEventListener('input', (event) => {
                    const searchTerm = event.target.value.toLowerCase();
                    filterDatabases();
                    
                    // Show/hide clear button based on input value
                    if (searchTerm.length > 0) {
                        databasesSearchClear.style.display = 'flex';
                    } else {
                        databasesSearchClear.style.display = 'none';
                    }
                });

                // Clear button functionality
                databasesSearchClear.addEventListener('click', () => {
                    databasesSearchInput.value = '';
                    databasesSearchClear.style.display = 'none';
                    filterDatabases();
                    databasesSearchInput.focus();
                });
            }

            function filterDatabases() {
                const searchTerm = databasesSearchInput ? databasesSearchInput.value.toLowerCase() : '';
                const rows = document.querySelectorAll('#databases-table tbody tr');
                const noMatchesMessage = document.getElementById('no-database-matches-message');
                let visibleCount = 0;
                
                rows.forEach(row => {
                    const databaseText = row.textContent.toLowerCase();
                    const matchesSearch = searchTerm === '' || databaseText.includes(searchTerm);
                    
                    // Additional filter logic can be added here
                    row.style.display = matchesSearch ? '' : 'none';
                    if (matchesSearch) visibleCount++;
                });
                
                // Show/hide no matches message
                if (searchTerm.length > 0 && visibleCount === 0) {
                    noMatchesMessage.classList.remove('hidden');
                } else {
                    noMatchesMessage.classList.add('hidden');
                }
            }

            // Initialize database filter states
            const databaseFilterStates = {
                type: [],
                status: []
            };

            // Database filter functionality
            const databaseFilterButtons = ['database-type-filter-btn', 'database-status-filter-btn'];
            const databaseFilterDropdowns = ['database-type-filter-dropdown', 'database-status-filter-dropdown'];
            
            // Toggle database filter dropdowns
            databaseFilterButtons.forEach((btnId, index) => {
                const button = document.getElementById(btnId);
                if (button) {
                    const dropdown = document.getElementById(databaseFilterDropdowns[index]);
                    
                    button.addEventListener('click', (event) => {
                        event.stopPropagation();
                        
                        // Close other dropdowns
                        databaseFilterDropdowns.forEach((dropdownId, i) => {
                            if (i !== index) {
                                const otherDropdown = document.getElementById(dropdownId);
                                if (otherDropdown) {
                                    otherDropdown.classList.add('hidden');
                                }
                            }
                        });
                        
                        dropdown.classList.toggle('hidden');
                    });
                }
            });

            // Handle database filter checkbox changes
            document.querySelectorAll('#database-type-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    updateDatabaseFilterState('type', checkbox.value, checkbox.checked);
                    updateDatabaseFilterButton('database-type-filter-btn', databaseFilterStates.type);
                });
            });

            document.querySelectorAll('#database-status-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    updateDatabaseFilterState('status', checkbox.value, checkbox.checked);
                    updateDatabaseFilterButton('database-status-filter-btn', databaseFilterStates.status);
                });
            });

            function updateDatabaseFilterState(filterType, value, checked) {
                if (checked) {
                    if (!databaseFilterStates[filterType].includes(value)) {
                        databaseFilterStates[filterType].push(value);
                    }
                } else {
                    databaseFilterStates[filterType] = databaseFilterStates[filterType].filter(item => item !== value);
                }
            }

            function updateDatabaseFilterButton(buttonId, selectedValues) {
                const button = document.getElementById(buttonId);
                if (!button) return;
                
                const buttonText = button.querySelector('span:first-child');
                
                // Handle different filter types with proper clear button IDs
                let clearBtnId;
                let defaultText;
                
                if (buttonId === 'database-type-filter-btn') {
                    clearBtnId = 'database-type-clear-btn';
                    defaultText = 'Type';
                } else if (buttonId === 'database-status-filter-btn') {
                    clearBtnId = 'database-status-clear-btn';
                    defaultText = 'Status';
                }
                
                const clearBtn = document.getElementById(clearBtnId);
                
                if (selectedValues.length === 0) {
                    buttonText.textContent = defaultText;
                    if (clearBtn) clearBtn.classList.add('hidden');
                } else {
                    buttonText.textContent = selectedValues.join(', ');
                    if (clearBtn) clearBtn.classList.remove('hidden');
                }
                
                // Update "Clear All Filters" button visibility
                updateDatabaseClearAllFiltersButton();
            }

            function updateDatabaseClearAllFiltersButton() {
                const clearAllBtn = document.getElementById('clear-all-database-filters-btn');
                if (!clearAllBtn) return;
                
                const hasAnyFilters = databaseFilterStates.type.length > 0 || databaseFilterStates.status.length > 0;
                
                if (hasAnyFilters) {
                    clearAllBtn.classList.remove('hidden');
                } else {
                    clearAllBtn.classList.add('hidden');
                }
            }

            const databaseTypeClearBtn = document.getElementById('database-type-clear-btn');
            if (databaseTypeClearBtn) {
                databaseTypeClearBtn.addEventListener('click', (event) => {
                    event.stopPropagation();
                    clearDatabaseFilter('type');
                });
            }

            const databaseStatusClearBtn = document.getElementById('database-status-clear-btn');
            if (databaseStatusClearBtn) {
                databaseStatusClearBtn.addEventListener('click', (event) => {
                    event.stopPropagation();
                    clearDatabaseFilter('status');
                });
            }

            // Clear all database filters button
            const clearAllDatabaseFiltersBtn = document.getElementById('clear-all-database-filters-btn');
            if (clearAllDatabaseFiltersBtn) {
                clearAllDatabaseFiltersBtn.addEventListener('click', () => {
                    clearAllDatabaseFilters();
                });
            }

            function clearDatabaseFilter(filterType) {
                // Clear the filter state
                databaseFilterStates[filterType] = [];
                
                // Uncheck all checkboxes in the dropdown
                let dropdownId;
                let buttonId;
                
                if (filterType === 'type') {
                    dropdownId = 'database-type-filter-dropdown';
                    buttonId = 'database-type-filter-btn';
                } else if (filterType === 'status') {
                    dropdownId = 'database-status-filter-dropdown';
                    buttonId = 'database-status-filter-btn';
                }
                
                document.querySelectorAll(`#${dropdownId} input[type="checkbox"]`).forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Update the button text
                updateDatabaseFilterButton(buttonId, []);
                
                // Close the dropdown
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    dropdown.classList.add('hidden');
                }
            }

            function clearAllDatabaseFilters() {
                // Clear all filter states
                databaseFilterStates.type = [];
                databaseFilterStates.status = [];
                
                // Uncheck all checkboxes in each dropdown
                document.querySelectorAll('#database-type-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                document.querySelectorAll('#database-status-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Update each button text
                updateDatabaseFilterButton('database-type-filter-btn', []);
                updateDatabaseFilterButton('database-status-filter-btn', []);
                
                // Close all database filter dropdowns
                databaseFilterDropdowns.forEach(dropdownId => {
                    const dropdown = document.getElementById(dropdownId);
                    if (dropdown) {
                        dropdown.classList.add('hidden');
                    }
                });
            }

            // Create Database Modal Functionality
            const createDatabaseModal = document.getElementById('create-database-modal');
            const closeCreateDatabaseModal = document.getElementById('close-create-database-modal');
            const cancelCreateDatabase = document.getElementById('cancel-create-database');
            const confirmCreateDatabase = document.getElementById('confirm-create-database');


            // Event Listeners for Create Database Modal
            // Find the Create Connection button by looking for the button with "Create Connection" text
            const createDatabaseButton = Array.from(document.querySelectorAll('button')).find(btn => 
                btn.textContent.includes('Create Connection')
            );
            
            if (createDatabaseButton) {
                createDatabaseButton.addEventListener('click', openCreateDatabaseModal);
            }

            if (closeCreateDatabaseModal) {
                closeCreateDatabaseModal.addEventListener('click', closeCreateDatabaseModalFunction);
            }

            if (cancelCreateDatabase) {
                cancelCreateDatabase.addEventListener('click', closeCreateDatabaseModalFunction);
            }

            // Edit Database Modal Functionality
            const editDatabaseModal = document.getElementById('edit-database-modal');
            const closeEditDatabaseModal = document.getElementById('close-edit-database-modal');
            const cancelEditDatabase = document.getElementById('cancel-edit-database');
            const confirmEditDatabase = document.getElementById('confirm-edit-database');

            if (closeEditDatabaseModal) {
                closeEditDatabaseModal.addEventListener('click', closeEditDatabaseModalFunction);
            }

            if (cancelEditDatabase) {
                cancelEditDatabase.addEventListener('click', closeEditDatabaseModalFunction);
            }

        // Add event delegation to database table for row clicks
        const databasesTable = document.getElementById('databases-table');
        if (databasesTable) {
            databasesTable.addEventListener('click', (event) => {
                // Check if clicked element is a table row
                const row = event.target.closest('tbody tr');
                if (row) {
                    // Don't open modal if clicking on dropdown button
                    if (event.target.closest('.options-dropdown-button')) {
                        return;
                    }
                    openDatabaseDetailsModal();
                }
            });
        }

        // API Tree Functionality
        const apisTable = document.getElementById('apis-table');
        if (apisTable) {
            // Handle expand/collapse collection buttons
            apisTable.addEventListener('click', (event) => {
                const expandBtn = event.target.closest('.expand-collection-btn');
                if (expandBtn) {
                    event.stopPropagation();
                    const collectionId = expandBtn.getAttribute('data-collection');
                    toggleAPICollection(collectionId);
                    return;
                }

                // Handle row clicks for collections and requests
                const row = event.target.closest('tbody tr');
                if (row) {
                    // Don't open modal if clicking on dropdown button
                    if (event.target.closest('.options-dropdown-button')) {
                        return;
                    }

                    // Check if it's a collection or request row
                    if (row.classList.contains('api-collection-row')) {
                        const collectionId = row.getAttribute('data-collection-id');
                        openAPICollectionModal(collectionId);
                    } else if (row.classList.contains('api-request-row')) {
                        const requestId = row.getAttribute('data-request-id');
                        openAPIRequestModal(requestId);
                    }
                }
            });
        }

        // Function to toggle API collection expand/collapse
        function toggleAPICollection(collectionId) {
            const expandBtn = document.querySelector(`[data-collection="${collectionId}"].expand-collection-btn`);
            const requestRows = document.querySelectorAll(`[data-collection="${collectionId}"].api-request-row`);
            const chevron = expandBtn.querySelector('.material-symbols-outlined');
            
            if (requestRows[0] && requestRows[0].classList.contains('hidden')) {
                // Expand collection
                requestRows.forEach(row => row.classList.remove('hidden'));
                chevron.textContent = 'expand_more';
            } else {
                // Collapse collection
                requestRows.forEach(row => row.classList.add('hidden'));
                chevron.textContent = 'chevron_right';
            }
        }


        // Function to get the first request ID for a collection
        function getFirstRequestIdForCollection(collectionId) {
            // Map collection IDs to their first request IDs
            const collectionToFirstRequest = {
                '1': '1.1', // Weather Services -> Get Current Weather
                '2': '2.1'  // Traffic Services -> Get Traffic Flow
            };
            return collectionToFirstRequest[collectionId];
        }






        // Function to open Create API Collection modal
        function openCreateAPICollectionModal() {
            openCreateCollectionModal();
        }
        
        // Make function global
        window.openCreateAPICollectionModal = openCreateAPICollectionModal;

        // API Search and Filter Functionality
        const apisSearchInput = document.getElementById('apis-search-input');
        const apisFilterButton = document.getElementById('apis-filter-button');
        const apisFilterDropdown = document.getElementById('apis-filter-dropdown');

        // API Search functionality
        if (apisSearchInput) {
            apisSearchInput.addEventListener('input', filterAPIs);
        }

        // API Filter dropdown functionality
        if (apisFilterButton && apisFilterDropdown) {
            apisFilterButton.addEventListener('click', (event) => {
                event.stopPropagation();
                apisFilterDropdown.classList.toggle('hidden');
            });
        }

        // Close API filter dropdown when clicking outside
        document.addEventListener('click', (event) => {
            if (apisFilterDropdown && !apisFilterDropdown.contains(event.target) && !apisFilterButton.contains(event.target)) {
                apisFilterDropdown.classList.add('hidden');
            }
        });

        function filterAPIs() {
            const searchTerm = apisSearchInput ? apisSearchInput.value.toLowerCase() : '';
            const rows = document.querySelectorAll('#apis-table tbody tr');
            const noMatchesMessage = document.getElementById('no-api-matches-message');
            let visibleCount = 0;
            
            rows.forEach(row => {
                const apiText = row.textContent.toLowerCase();
                const matchesSearch = searchTerm === '' || apiText.includes(searchTerm);
                
                // Additional filter logic can be added here
                row.style.display = matchesSearch ? '' : 'none';
                if (matchesSearch) visibleCount++;
            });
            
            // Show/hide no matches message
            if (searchTerm.length > 0 && visibleCount === 0) {
                noMatchesMessage.classList.remove('hidden');
            } else {
                noMatchesMessage.classList.add('hidden');
            }
        }

        // API Filter States
        const apiFilterStates = {
            authType: [],
            method: [],
            status: []
        };

        // API filter functionality
        const apiFilterButtons = ['api-auth-type-filter-btn', 'api-method-filter-btn', 'api-status-filter-btn'];
        const apiFilterDropdowns = ['api-auth-type-filter-dropdown', 'api-method-filter-dropdown', 'api-status-filter-dropdown'];
        
        // Toggle API filter dropdowns
        apiFilterButtons.forEach((btnId, index) => {
            const button = document.getElementById(btnId);
            const dropdown = document.getElementById(apiFilterDropdowns[index]);
            
            if (button && dropdown) {
                button.addEventListener('click', (event) => {
                    event.stopPropagation();
                    
                    // Close all other API filter dropdowns
                    apiFilterDropdowns.forEach(dropdownId => {
                        const otherDropdown = document.getElementById(dropdownId);
                        if (otherDropdown && otherDropdown.id !== dropdown.id) {
                            otherDropdown.classList.add('hidden');
                        }
                    });
                    
                    // Toggle current dropdown
                    dropdown.classList.toggle('hidden');
                });
            }
        });

        // Handle API filter checkbox changes
        document.querySelectorAll('#api-auth-type-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                updateAPIFilterState('authType', checkbox.value, checkbox.checked);
                updateAPIFilterButton('api-auth-type-filter-btn', apiFilterStates.authType);
                updateAPIClearAllFiltersButton();
            });
        });

        document.querySelectorAll('#api-method-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                updateAPIFilterState('method', checkbox.value, checkbox.checked);
                updateAPIFilterButton('api-method-filter-btn', apiFilterStates.method);
                updateAPIClearAllFiltersButton();
            });
        });

        document.querySelectorAll('#api-status-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                updateAPIFilterState('status', checkbox.value, checkbox.checked);
                updateAPIFilterButton('api-status-filter-btn', apiFilterStates.status);
                updateAPIClearAllFiltersButton();
            });
        });

        // Update API filter button text and clear button visibility
        function updateAPIFilterButton(buttonId, selectedValues) {
            const button = document.getElementById(buttonId);
            if (!button) return;
            
            const buttonText = button.querySelector('span:first-child');
            const clearBtn = button.querySelector('[id$="-clear-btn"]');
            
            if (selectedValues.length === 0) {
                // Handle different filter types with proper clear button IDs
                let clearBtnId;
                let defaultText;
                
                if (buttonId === 'api-auth-type-filter-btn') {
                    clearBtnId = 'api-auth-type-clear-btn';
                    defaultText = 'Authentication Type';
                } else if (buttonId === 'api-method-filter-btn') {
                    clearBtnId = 'api-method-clear-btn';
                    defaultText = 'Method';
                } else if (buttonId === 'api-status-filter-btn') {
                    clearBtnId = 'api-status-clear-btn';
                    defaultText = 'Status';
                }
                
                buttonText.textContent = defaultText;
                if (clearBtn) clearBtn.classList.add('hidden');
            } else {
                buttonText.textContent = `${selectedValues.length} selected`;
                if (clearBtn) clearBtn.classList.remove('hidden');
            }
        }

        // Update API filter state
        function updateAPIFilterState(filterType, value, isChecked) {
            if (isChecked) {
                if (!apiFilterStates[filterType].includes(value)) {
                    apiFilterStates[filterType].push(value);
                }
            } else {
                apiFilterStates[filterType] = apiFilterStates[filterType].filter(v => v !== value);
            }
        }

        // Update Clear All Filters button visibility
        function updateAPIClearAllFiltersButton() {
            const clearAllBtn = document.getElementById('api-clear-all-filters-btn');
            const hasActiveFilters = apiFilterStates.authType.length > 0 || 
                                   apiFilterStates.method.length > 0 || 
                                   apiFilterStates.status.length > 0;
            
            if (clearAllBtn) {
                if (hasActiveFilters) {
                    clearAllBtn.classList.remove('hidden');
                } else {
                    clearAllBtn.classList.add('hidden');
                }
            }
        }

        // Clear API filter
        function clearAPIFilter(filterType) {
            apiFilterStates[filterType] = [];
            
            // Uncheck all checkboxes in the dropdown
            let dropdownId;
            let buttonId;
            
            if (filterType === 'authType') {
                dropdownId = 'api-auth-type-filter-dropdown';
                buttonId = 'api-auth-type-filter-btn';
            } else if (filterType === 'method') {
                dropdownId = 'api-method-filter-dropdown';
                buttonId = 'api-method-filter-btn';
            } else if (filterType === 'status') {
                dropdownId = 'api-status-filter-dropdown';
                buttonId = 'api-status-filter-btn';
            }
            
            if (dropdownId) {
                document.querySelectorAll(`#${dropdownId} input[type="checkbox"]`).forEach(checkbox => {
                    checkbox.checked = false;
                });
            }
            
            // Update button text
            if (buttonId) {
                updateAPIFilterButton(buttonId, []);
            }
            
            // Close dropdown
            const dropdown = document.getElementById(dropdownId);
            if (dropdown) {
                dropdown.classList.add('hidden');
            }
        }

        // Clear all API filters
        function clearAllAPIFilters() {
            // Clear all filter states
            apiFilterStates.authType = [];
            apiFilterStates.method = [];
            apiFilterStates.status = [];
            
            // Uncheck all checkboxes
            document.querySelectorAll('#api-auth-type-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            document.querySelectorAll('#api-method-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            document.querySelectorAll('#api-status-filter-dropdown input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Update each button text
            updateAPIFilterButton('api-auth-type-filter-btn', []);
            updateAPIFilterButton('api-method-filter-btn', []);
            updateAPIFilterButton('api-status-filter-btn', []);
            
            // Hide Clear All Filters button
            updateAPIClearAllFiltersButton();
            
            // Close all API filter dropdowns
            apiFilterDropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    dropdown.classList.add('hidden');
                }
            });
        }

        // Add clear button event listeners
        document.getElementById('api-auth-type-clear-btn')?.addEventListener('click', (e) => {
            e.stopPropagation();
            clearAPIFilter('authType');
            updateAPIClearAllFiltersButton();
        });

        document.getElementById('api-method-clear-btn')?.addEventListener('click', (e) => {
            e.stopPropagation();
            clearAPIFilter('method');
            updateAPIClearAllFiltersButton();
        });

        document.getElementById('api-status-clear-btn')?.addEventListener('click', (e) => {
            e.stopPropagation();
            clearAPIFilter('status');
            updateAPIClearAllFiltersButton();
        });

        // Add Clear All Filters button event listener
        document.getElementById('api-clear-all-filters-btn')?.addEventListener('click', (e) => {
            e.stopPropagation();
            clearAllAPIFilters();
        });

        // Add API dropdown button event listeners
        document.querySelectorAll('button[data-dropdown]').forEach(button => {
            button.addEventListener('click', (e) => {
                e.stopPropagation();
                const dropdownId = button.getAttribute('data-dropdown') + '-dropdown';
                toggleDropdown(dropdownId);
            });
        });

        // Close API filter dropdowns when clicking outside
        document.addEventListener('click', (event) => {
            apiFilterDropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                const button = document.getElementById(dropdownId.replace('-dropdown', '-btn'));
                
                if (dropdown && !dropdown.contains(event.target) && !button.contains(event.target)) {
                    dropdown.classList.add('hidden');
                }
            });

            // Close API row dropdowns when clicking outside
            document.querySelectorAll('button[data-dropdown]').forEach(button => {
                const dropdownId = button.getAttribute('data-dropdown') + '-dropdown';
                const dropdown = document.getElementById(dropdownId);
                
                if (dropdown && !dropdown.contains(event.target) && !button.contains(event.target)) {
                    dropdown.classList.add('hidden');
                }
            });
        });


            // Button click handling is now done via inline onclick attribute

            // Close modal when clicking outside
            if (createDatabaseModal) {
                createDatabaseModal.addEventListener('click', (event) => {
                    if (event.target === createDatabaseModal) {
                        closeCreateDatabaseModalFunction();
                    }
                });
            }

        });

        // Database Details Modal Functionality
        // Function to open database details modal
        function openDatabaseDetailsModal() {
            const databaseDetailsModal = document.getElementById('database-details-modal');
            if (databaseDetailsModal) {
                databaseDetailsModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Initialize database action dropdown
                initializeDatabaseActionDropdown();
                
                // Set up close button event listener when modal opens
                const closeDatabaseDetailsModal = document.getElementById('close-database-details-modal');
                if (closeDatabaseDetailsModal) {
                    // Remove any existing event listener to avoid duplicates
                    closeDatabaseDetailsModal.removeEventListener('click', closeDatabaseDetailsModalFunction);
                    closeDatabaseDetailsModal.addEventListener('click', closeDatabaseDetailsModalFunction);
                }
            }
        }

        // Function to close database details modal
        function closeDatabaseDetailsModalFunction() {
            const databaseDetailsModal = document.getElementById('database-details-modal');
            if (databaseDetailsModal) {
                databaseDetailsModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        // Close button event listener is now set up when modal opens

        // Close database details modal when clicking outside
        document.addEventListener('click', (event) => {
            const databaseDetailsModal = document.getElementById('database-details-modal');
            if (databaseDetailsModal && event.target === databaseDetailsModal) {
                closeDatabaseDetailsModalFunction();
            }
        });


        // Database Results Tab Switching
        function initializeDatabaseResultsTabs() {
            const databaseResultsTabs = document.querySelectorAll('.database-results-tab');
            const databaseResultsTabContents = document.querySelectorAll('.database-results-tab-content');
            
            databaseResultsTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetDatabaseResultsTab = tab.getAttribute('data-database-results-tab');
                    
                    // Reset all database results tabs to inactive state
                    databaseResultsTabs.forEach(t => {
                        t.classList.remove('bg-blue-600', 'text-white');
                        t.classList.add('bg-gray-700', 'text-gray-400', 'hover:bg-gray-600');
                        t.classList.remove('rounded-l-md', 'border-r', 'border-gray-600');
                        t.classList.add('rounded-r-md');
                    });
                    
                    // Set the clicked tab to active state
                    tab.classList.add('bg-blue-600', 'text-white');
                    tab.classList.remove('bg-gray-700', 'text-gray-400', 'hover:bg-gray-600');
                    
                    // Handle border styling for button group based on which tab is active
                    if (targetDatabaseResultsTab === 'database-query-result') {
                        // Database Query Result is active - it should be left rounded with border
                        tab.classList.add('rounded-l-md', 'border-r', 'border-gray-600');
                        tab.classList.remove('rounded-r-md');
                        
                        // Database Datapoints Summary should be right rounded without border
                        const databaseDatapointsTab = document.querySelector('[data-database-results-tab="database-datapoints-summary"]');
                        if (databaseDatapointsTab) {
                            databaseDatapointsTab.classList.add('rounded-r-md');
                            databaseDatapointsTab.classList.remove('rounded-l-md', 'border-r', 'border-gray-600');
                        }
                    } else {
                        // Database Datapoints Summary is active - it should be right rounded without border
                        tab.classList.add('rounded-r-md');
                        tab.classList.remove('rounded-l-md', 'border-r', 'border-gray-600');
                        
                        // Database Query Result should be left rounded with border
                        const databaseQueryTab = document.querySelector('[data-database-results-tab="database-query-result"]');
                        if (databaseQueryTab) {
                            databaseQueryTab.classList.add('rounded-l-md', 'border-r', 'border-gray-600');
                            databaseQueryTab.classList.remove('rounded-r-md');
                        }
                    }
                    
                    // Hide all database results tab content
                    databaseResultsTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Show target database results tab content
                    const targetContent = document.getElementById(targetDatabaseResultsTab + '-content');
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
        }

            // Initialize database results tabs when DOM is loaded
            document.addEventListener('DOMContentLoaded', function() {
                initializeDatabaseResultsTabs();
            });



        // Global dropdown functionality for user table
        function toggleDropdown(dropdownId) {
            // Prevent duplicate calls with invalid IDs
            if (!dropdownId || dropdownId.includes('dropdown-dropdown')) {
                return;
            }
            
            // Close all other grid dropdowns (user, component, database, and api grid dropdowns) but NOT filter dropdowns
            document.querySelectorAll('[id^="dropdown-"], [id^="component-dropdown-"], [id^="database-dropdown-"], [id$="-dropdown"]').forEach(dropdown => {
                if (dropdown.id !== dropdownId) {
                    dropdown.classList.add('hidden');
                }
            });
            
            // Get the dropdown and button
            const dropdown = document.getElementById(dropdownId);
            const button = window.event ? window.event.target.closest('button') : event.target.closest('button');
            
            if (!dropdown) {
                return;
            }
            
            // Toggle the clicked dropdown
            dropdown.classList.toggle('hidden');
            
            // All dropdowns now use body-append functionality for consistent behavior
            
            if (!dropdown.classList.contains('hidden')) {
                // Ensure dropdown is appended to body if not already
                if (dropdown.parentElement !== document.body) {
                    document.body.appendChild(dropdown);
                }
                
                // Position the dropdown relative to the button
                const buttonRect = button.getBoundingClientRect();
                dropdown.style.position = 'fixed';
                dropdown.style.top = (buttonRect.bottom + 8) + 'px';
                dropdown.style.right = (window.innerWidth - buttonRect.right) + 'px';
            }
        }

        // Single-selection dropdown functionality for Data Binding tab
        document.addEventListener('DOMContentLoaded', function() {

            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                const allDropdowns = document.querySelectorAll('[id$="-dropdown"]');
                const allButtons = document.querySelectorAll('[id$="-btn"]');
                
                let clickedInsideDropdown = false;
                let clickedInsideButton = false;
                
                allDropdowns.forEach(dropdown => {
                    if (dropdown.contains(e.target)) {
                        clickedInsideDropdown = true;
                    }
                });
                
                allButtons.forEach(button => {
                    if (button.contains(e.target)) {
                        clickedInsideButton = true;
                    }
                });
                
                if (!clickedInsideDropdown && !clickedInsideButton) {
                    allDropdowns.forEach(dropdown => {
                        dropdown.classList.add('hidden');
                    });
                }
            });

            
        });

        // Edit Collection Modal Functions
        function openEditCollectionModal() {
            const editModal = document.getElementById('edit-collection-modal');
            if (editModal) {
                editModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Initialize edit collection tabs
                initializeEditCollectionTabs();
                
                // Initialize drag and drop for variables
                setTimeout(() => {
                    initializeDragAndDrop('#edit-collection-variables-content .space-y-2');
                }, 100);
                
                // Set up close button event listener
                const closeEditModal = document.getElementById('close-edit-collection-modal');
                const cancelEditModal = document.getElementById('cancel-edit-collection');
                const saveEditModal = document.getElementById('save-edit-collection');
                if (closeEditModal) {
                    closeEditModal.removeEventListener('click', closeEditCollectionModal);
                    closeEditModal.addEventListener('click', closeEditCollectionModal);
                }
                if (cancelEditModal) {
                    cancelEditModal.removeEventListener('click', closeEditCollectionModal);
                    cancelEditModal.addEventListener('click', closeEditCollectionModal);
                }
                if (saveEditModal) {
                    saveEditModal.removeEventListener('click', closeEditCollectionModal);
                    saveEditModal.addEventListener('click', closeEditCollectionModal);
                }
                
                // Set up outside click handler
                const handleOutsideClick = (event) => {
                    if (event.target === editModal) {
                        closeEditCollectionModal();
                        editModal.removeEventListener('click', handleOutsideClick);
                    }
                };
                editModal.addEventListener('click', handleOutsideClick);
            }
        }

        function closeEditCollectionModal() {
            const editModal = document.getElementById('edit-collection-modal');
            if (editModal) {
                editModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function initializeEditCollectionTabs() {
            const editCollectionTabs = document.querySelectorAll('.edit-collection-tab');
            const editCollectionTabContents = document.querySelectorAll('.edit-collection-tab-content');
            
            // Show the first tab content by default
            editCollectionTabContents.forEach((content, index) => {
                if (index === 0) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            });
            
            // Reset all tabs to inactive state
            editCollectionTabs.forEach(tab => {
                tab.classList.remove('border-red-500', 'text-white');
                tab.classList.add('border-transparent', 'text-gray-400');
            });
            
            // Set first tab as active
            if (editCollectionTabs.length > 0) {
                editCollectionTabs[0].classList.remove('border-transparent', 'text-gray-400');
                editCollectionTabs[0].classList.add('border-red-500', 'text-white');
            }
            
            // Add click event listeners to tabs
            editCollectionTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetEditCollectionTab = tab.getAttribute('data-edit-collection-tab');
                    
                    // Reset all edit collection tabs to inactive state
                    editCollectionTabs.forEach(t => {
                        t.classList.remove('border-red-500', 'text-white');
                        t.classList.add('border-transparent', 'text-gray-400');
                    });
                    
                    // Add active class to clicked tab
                    tab.classList.remove('border-transparent', 'text-gray-400');
                    tab.classList.add('border-red-500', 'text-white');
                    
                    // Hide all edit collection tab contents
                    editCollectionTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Show the target edit collection tab content
                    const targetContent = document.getElementById(`edit-collection-${targetEditCollectionTab}-content`);
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
        }

        // Edit Request Modal Functions
        function openEditRequestModal() {
            const editRequestModal = document.getElementById('edit-request-modal');
            if (editRequestModal) {
                editRequestModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Set up close button event listener
                const closeEditRequestModal = document.getElementById('close-edit-request-modal');
                const cancelEditRequestModal = document.getElementById('cancel-edit-request');
                const saveEditRequestModal = document.getElementById('save-edit-request');
                if (closeEditRequestModal) {
                    closeEditRequestModal.removeEventListener('click', closeEditRequestModalFunction);
                    closeEditRequestModal.addEventListener('click', closeEditRequestModalFunction);
                }
                if (cancelEditRequestModal) {
                    cancelEditRequestModal.removeEventListener('click', closeEditRequestModalFunction);
                    cancelEditRequestModal.addEventListener('click', closeEditRequestModalFunction);
                }
                if (saveEditRequestModal) {
                    saveEditRequestModal.removeEventListener('click', closeEditRequestModalFunction);
                    saveEditRequestModal.addEventListener('click', closeEditRequestModalFunction);
                }
                
                // Set up outside click handler
                const handleOutsideClick = (event) => {
                    if (event.target === editRequestModal) {
                        closeEditRequestModalFunction();
                        editRequestModal.removeEventListener('click', handleOutsideClick);
                    }
                };
                editRequestModal.addEventListener('click', handleOutsideClick);
            }
        }

        function closeEditRequestModalFunction() {
            const editRequestModal = document.getElementById('edit-request-modal');
            if (editRequestModal) {
                editRequestModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        // Initialize dropdown functionality for Collection and Request actions
        function initializeActionDropdowns() {
            // Collection Actions Dropdown
            const collectionDropdownBtn = document.getElementById('collection-actions-dropdown-btn');
            const collectionDropdown = document.getElementById('collection-actions-dropdown');
            
            if (collectionDropdownBtn && collectionDropdown) {
                collectionDropdownBtn.addEventListener('click', (event) => {
                    event.stopPropagation();
                    
                    // Close all other dropdowns
                    document.querySelectorAll('[id$="-dropdown"]').forEach(dropdown => {
                        if (dropdown.id !== 'collection-actions-dropdown') {
                            dropdown.classList.add('hidden');
                        }
                    });
                    
                    // Toggle this dropdown
                    collectionDropdown.classList.toggle('hidden');
                });
            }
            
            // Request Actions Dropdown
            const requestDropdownBtn = document.getElementById('request-actions-dropdown-btn');
            const requestDropdown = document.getElementById('request-actions-dropdown');
            
            if (requestDropdownBtn && requestDropdown) {
                requestDropdownBtn.addEventListener('click', (event) => {
                    event.stopPropagation();
                    
                    // Close all other dropdowns
                    document.querySelectorAll('[id$="-dropdown"]').forEach(dropdown => {
                        if (dropdown.id !== 'request-actions-dropdown') {
                            dropdown.classList.add('hidden');
                        }
                    });
                    
                    // Toggle this dropdown
                    requestDropdown.classList.toggle('hidden');
                });
            }
        }

        // Create Request Modal Functions
        function openCreateRequestModal() {
            const createRequestModal = document.getElementById('create-request-modal');
            if (createRequestModal) {
                createRequestModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Auto-focus the Name field
                setTimeout(() => {
                    const nameField = document.getElementById('create-request-name');
                    if (nameField) {
                        nameField.focus();
                    }
                }, 100);
                
                // Set up close button event listener
                const closeCreateRequestModal = document.getElementById('close-create-request-modal');
                const cancelCreateRequestModal = document.getElementById('cancel-create-request');
                const saveCreateRequestModal = document.getElementById('save-create-request');
                if (closeCreateRequestModal) {
                    closeCreateRequestModal.removeEventListener('click', closeCreateRequestModalFunction);
                    closeCreateRequestModal.addEventListener('click', closeCreateRequestModalFunction);
                }
                if (cancelCreateRequestModal) {
                    cancelCreateRequestModal.removeEventListener('click', closeCreateRequestModalFunction);
                    cancelCreateRequestModal.addEventListener('click', closeCreateRequestModalFunction);
                }
                if (saveCreateRequestModal) {
                    saveCreateRequestModal.removeEventListener('click', handleCreateRequestSave);
                    saveCreateRequestModal.addEventListener('click', handleCreateRequestSave);
                }
                
                // Set up outside click handler
                const handleOutsideClick = (event) => {
                    if (event.target === createRequestModal) {
                        closeCreateRequestModalFunction();
                        createRequestModal.removeEventListener('click', handleOutsideClick);
                    }
                };
                createRequestModal.addEventListener('click', handleOutsideClick);
            }
        }

        function closeCreateRequestModalFunction() {
            const createRequestModal = document.getElementById('create-request-modal');
            if (createRequestModal) {
                createRequestModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function handleCreateRequestSave() {
            // Close the Create Request modal
            closeCreateRequestModalFunction();
            
            // Open the API Collection modal with the second Request tab active
            openAPIRequestModal('1.2');
        }

        // Create Collection Modal Functions
        function openCreateCollectionModal() {
            const createCollectionModal = document.getElementById('create-collection-modal');
            if (createCollectionModal) {
                createCollectionModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Auto-focus the Name field
                setTimeout(() => {
                    const nameField = document.getElementById('create-collection-name');
                    if (nameField) {
                        nameField.focus();
                    }
                }, 100);
                
                initializeCreateCollectionTabs();
                
                setTimeout(() => {
                    initializeDragAndDrop('#create-collection-variables-content .space-y-2');
                }, 100);
                
                const closeCreateCollectionModal = document.getElementById('close-create-collection-modal');
                const cancelCreateCollectionModal = document.getElementById('cancel-create-collection');
                const saveCreateCollectionModal = document.getElementById('save-create-collection');
                if (closeCreateCollectionModal) {
                    closeCreateCollectionModal.removeEventListener('click', closeCreateCollectionModalFunction);
                    closeCreateCollectionModal.addEventListener('click', closeCreateCollectionModalFunction);
                }
                if (cancelCreateCollectionModal) {
                    cancelCreateCollectionModal.removeEventListener('click', closeCreateCollectionModalFunction);
                    cancelCreateCollectionModal.addEventListener('click', closeCreateCollectionModalFunction);
                }
                if (saveCreateCollectionModal) {
                    saveCreateCollectionModal.removeEventListener('click', handleCreateCollectionSave);
                    saveCreateCollectionModal.addEventListener('click', handleCreateCollectionSave);
                }
                
                const handleOutsideClick = (event) => {
                    if (event.target === createCollectionModal) {
                        closeCreateCollectionModalFunction();
                        createCollectionModal.removeEventListener('click', handleOutsideClick);
                    }
                };
                createCollectionModal.addEventListener('click', handleOutsideClick);
            }
        }

        function closeCreateCollectionModalFunction() {
            const createCollectionModal = document.getElementById('create-collection-modal');
            if (createCollectionModal) {
                createCollectionModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function handleCreateCollectionSave() {
            // Close the Create Collection modal
            closeCreateCollectionModalFunction();
            
            // Open the API Collection modal immediately
            openAPICollectionModal();
        }

        function initializeCreateCollectionTabs() {
            const createCollectionTabs = document.querySelectorAll('.create-collection-tab');
            const createCollectionTabContents = document.querySelectorAll('.create-collection-tab-content');
            
            createCollectionTabContents.forEach((content, index) => {
                if (index === 0) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            });
            
            createCollectionTabs.forEach(tab => {
                tab.classList.remove('border-red-500', 'text-white');
                tab.classList.add('border-transparent', 'text-gray-400');
            });
            
            if (createCollectionTabs.length > 0) {
                createCollectionTabs[0].classList.remove('border-transparent', 'text-gray-400');
                createCollectionTabs[0].classList.add('border-red-500', 'text-white');
            }
            
            createCollectionTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetCreateCollectionTab = tab.getAttribute('data-create-collection-tab');
                    
                    createCollectionTabs.forEach(t => {
                        t.classList.remove('border-red-500', 'text-white');
                        t.classList.add('border-transparent', 'text-gray-400');
                    });
                    
                    tab.classList.remove('border-transparent', 'text-gray-400');
                    tab.classList.add('border-red-500', 'text-white');
                    
                    createCollectionTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    const targetContent = document.getElementById(`create-collection-${targetCreateCollectionTab}-content`);
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
        }

        // Edit Database Modal Function
        function openEditDatabaseModal() {
            const editDatabaseModal = document.getElementById('edit-database-modal');
            if (editDatabaseModal) {
                editDatabaseModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Prefill form with first database connection data
                document.getElementById('edit-database-name').value = 'Population Analytics';
                document.getElementById('edit-database-type').value = 'mysql';
                document.getElementById('edit-database-host').value = 'population-analytics-db.company.com';
                document.getElementById('edit-database-port').value = '3306';
                document.getElementById('edit-database-dbname').value = 'population_analytics_db';
                document.getElementById('edit-database-username').value = 'app_user';
                document.getElementById('edit-database-password').value = '••••••••';
                
                // Reset button state
                const confirmButton = document.getElementById('confirm-edit-database');
                if (confirmButton) {
                    confirmButton.innerHTML = 'Test Connection';
                    confirmButton.disabled = false;
                    confirmButton.classList.remove('bg-green-600', 'hover:bg-green-700');
                    confirmButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
                }
                
                // Hide test results
                const testResultsArea = document.getElementById('edit-test-results-area');
                if (testResultsArea) {
                    testResultsArea.classList.add('hidden');
                }
                
                // Set up outside click handler
                const handleOutsideClick = (event) => {
                    if (event.target === editDatabaseModal) {
                        closeEditDatabaseModalFunction();
                    }
                };
                editDatabaseModal.addEventListener('click', handleOutsideClick);
            }
        }

        function closeEditDatabaseModalFunction() {
            const editDatabaseModal = document.getElementById('edit-database-modal');
            if (editDatabaseModal) {
                editDatabaseModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function handleEditConfirmButtonClick(event) {
            event.preventDefault();
            
            const confirmButton = event.target;
            const buttonText = confirmButton.textContent.trim();
            
            if (buttonText === 'Test Connection') {
                // Show spinner in button
                confirmButton.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Testing...';
                confirmButton.disabled = true;
                confirmButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                confirmButton.classList.add('bg-gray-500', 'opacity-75', 'cursor-not-allowed');
                
                // Simulate connection test
                setTimeout(() => {
                    // Show test results
                    const testResultsArea = document.getElementById('edit-test-results-area');
                    if (testResultsArea) {
                        testResultsArea.classList.remove('hidden');
                    }
                    
                    // Scroll to bottom with animation to show results
                    setTimeout(() => {
                        const modalContent = document.getElementById('edit-database-modal-content');
                        if (modalContent) {
                            modalContent.scrollTo({
                                top: modalContent.scrollHeight,
                                behavior: 'smooth'
                            });
                        }
                    }, 100);
                    
                    // Update button to "Save Changes" with blue styling
                    confirmButton.innerHTML = 'Save Changes';
                    confirmButton.disabled = false;
                    confirmButton.classList.remove('bg-gray-500', 'opacity-75', 'cursor-not-allowed');
                    confirmButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
                }, 2000);
            } else if (buttonText === 'Save Changes') {
                // Close modal and open database details modal
                closeEditDatabaseModalFunction();
                openDatabaseDetailsModal();
            }
        }

        // Database Actions Dropdown Function
        function initializeDatabaseActionDropdown() {
            const databaseDropdownBtn = document.getElementById('database-actions-dropdown-btn');
            const databaseDropdown = document.getElementById('database-actions-dropdown');
            
            if (databaseDropdownBtn && databaseDropdown) {
                // Remove any existing event listener to avoid duplicates
                databaseDropdownBtn.removeEventListener('click', handleDatabaseDropdownClick);
                
                // Add the event listener
                databaseDropdownBtn.addEventListener('click', handleDatabaseDropdownClick);
            }
        }

        // Separate function for database dropdown click handler
        function handleDatabaseDropdownClick(event) {
            event.stopPropagation();
            
            const databaseDropdown = document.getElementById('database-actions-dropdown');
            if (databaseDropdown) {
                document.querySelectorAll('[id$="-dropdown"]').forEach(dropdown => {
                    if (dropdown.id !== 'database-actions-dropdown') {
                        dropdown.classList.add('hidden');
                    }
                });
                
                databaseDropdown.classList.toggle('hidden');
            }
        }

        // Make functions global
        window.openCreateDatabaseModal = openCreateDatabaseModal;
        window.openEditCollectionModal = openEditCollectionModal;
        window.closeEditCollectionModal = closeEditCollectionModal;
        window.openEditRequestModal = openEditRequestModal;
        window.closeEditRequestModalFunction = closeEditRequestModalFunction;
        window.openCreateRequestModal = openCreateRequestModal;
        window.closeCreateRequestModalFunction = closeCreateRequestModalFunction;
        window.openCreateCollectionModal = openCreateCollectionModal;
        window.closeCreateCollectionModalFunction = closeCreateCollectionModalFunction;
        window.openEditDatabaseModal = openEditDatabaseModal;
        window.closeEditDatabaseModalFunction = closeEditDatabaseModalFunction;
        window.handleEditConfirmButtonClick = handleEditConfirmButtonClick;
        window.initializeActionDropdowns = initializeActionDropdowns;
        window.initializeDatabaseActionDropdown = initializeDatabaseActionDropdown;
    </script>

    <!-- Create Database Modal -->
    <div id="create-database-modal" class="fixed inset-0 bg-black p-10 bg-opacity-50 flex justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1000px] flex flex-col">
            <!-- Modal Header -->
            <div class="py-4 px-6 border-b border-gray-700">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-white">Create Database Connection</h2>
                    <button id="close-create-database-modal" class="flex items-center text-gray-400 hover:text-white transition duration-200">
                        <span class="material-symbols-outlined text-2xl">close</span>
                    </button>
                </div>
            </div>

            <!-- Modal Content -->
            <div id="create-database-modal-content" class="flex-1 overflow-y-auto p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Connection Name <span class="text-red-400">*</span></label>
                        <input type="text" id="new-database-name" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter connection name" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Database Type <span class="text-red-400">*</span></label>
                        <div class="relative">
                            <select id="new-database-type" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none" required>
                                <option value="">Select database type</option>
                                <option value="mysql">MySQL</option>
                                <option value="postgresql">PostgreSQL</option>
                                <option value="sqlserver">SQL Server</option>
                                <option value="oracle">Oracle</option>
                                <option value="sqlite">SQLite</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Host <span class="text-red-400">*</span></label>
                        <input type="text" id="new-database-host" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter host" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Port <span class="text-red-400">*</span></label>
                        <input type="number" id="new-database-port" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter post" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Database Name <span class="text-red-400">*</span></label>
                        <input type="text" id="new-database-dbname" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter database name" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Username <span class="text-red-400">*</span></label>
                        <input type="text" id="new-database-username" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter username" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Password <span class="text-red-400">*</span></label>
                        <input type="password" id="new-database-password" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter password" required>
                    </div>
                </div>

                <!-- Test Results Area -->
                <div id="test-results-area" class="hidden mt-6">
                    <div class="bg-gray-800 border border-gray-600 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <span class="material-symbols-outlined text-green-400 mr-2">check_circle</span>
                            <h4 class="text-white font-medium">Connection Test Results</h4>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-400">Connection Status:</span>
                                <span class="text-green-400 font-medium">✓ Successful</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Response Time:</span>
                                <span class="text-white">45ms</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Database Version:</span>
                                <span class="text-white" id="db-version">MySQL 8.0.33</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Schema Access:</span>
                                <span class="text-green-400">✓ Granted</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Tables Found:</span>
                                <span class="text-white" id="tables-count">12 tables</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-gray-700">
                <div class="flex items-center justify-end space-x-3">
                    <button type="button" id="cancel-create-database" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition duration-200">
                        Cancel
                    </button>
                    <button type="button" id="confirm-create-database" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center" onclick="handleConfirmButtonClick(event)">
                        Test Connection
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Database Connection Details Modal -->
    <div id="database-details-modal" class="fixed inset-0 p-10 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1280px] flex flex-col">
            <!-- Modal Header -->
            <div class="p-6 border-b border-gray-700">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <h2 class="text-xl font-semibold text-white mr-4">Population Analytics</h2>
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-900 text-green-300">Active</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="openEditDatabaseModal()" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition duration-200 text-sm flex items-center">
                            <span class="material-symbols-outlined mr-2" style="font-size: 18px;">edit</span>
                            Edit Connection
                        </button>
                        <!-- Database Dropdown -->
                        <div class="relative">
                            <button id="database-actions-dropdown-btn" class="options-dropdown-button text-gray-400 hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400">
                                <span class="material-symbols-outlined text-lg">more_vert</span>
                            </button>
                            <div id="database-actions-dropdown" class="options-dropdown-menu absolute right-0 mt-2 w-50 rounded-md shadow-lg hidden">
                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Duplicate</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Export</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-200 transition duration-150">Deactivate</a>
                                <a href="#" class="block px-4 py-2 text-sm text-red-400 transition duration-150">Delete</a>
                            </div>
                        </div>
                        <!-- Close Button -->
                        <button id="close-database-details-modal" class="text-gray-400 hover:text-white transition duration-200 flex items-center">
                            <span class="material-symbols-outlined text-xl">close</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Modal Content -->
            <div class="flex flex-1 overflow-hidden">
                <!-- Left Column - Database Data -->
                <div class="w-full flex flex-col">
                    <!-- Fixed Content (Description, Metadata) -->
                    <div class="flex-shrink-0">
                        <!-- Description -->
                        <div class="py-4 px-6">
                            <div class="text-sm">
                                <div class="text-gray-500 mb-1">Description</div>
                                <div class="text-gray-300">Population and geographic data analysis results</div>
                            </div>
                        </div>
                        
                        <!-- Metadata -->
                        <div class="px-6 pb-4">
                            <div class="grid grid-cols-4 gap-4 text-sm">
                                <div>
                                    <div class="text-gray-500 mb-1">Type</div>
                                    <div class="text-gray-300">MySQL</div>
                                </div>
                                <div>
                                    <div class="text-gray-500 mb-1">Host</div>
                                    <div class="text-gray-300">population-analytics-db.company.com</div>
                                </div>
                                <div>
                                    <div class="text-gray-500 mb-1">Port</div>
                                    <div class="text-gray-300">3306</div>
                                </div>
                                <div>
                                    <div class="text-gray-500 mb-1">Database</div>
                                    <div class="text-gray-300">population_analytics</div>
                                </div>
                                <div>
                                    <div class="text-gray-500 mb-1">Username</div>
                                    <div class="text-gray-300">app_user</div>
                                </div>
                                <div>
                                    <div class="text-gray-500 mb-1">Created</div>
                                    <div class="text-gray-300">May 15, 2024 <span class="text-gray-500">(John Doe)</span></div>
                                </div>
                                <div>
                                    <div class="text-gray-500 mb-1">Last Updated</div>
                                    <div class="text-gray-300">Aug 23, 2024 <span class="text-gray-500">(John Doe)</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Query Section -->
                    <div class="border-b border-gray-700 mb-4"></div>
                    <div class="flex-1 overflow-y-auto px-6 pb-6">
                        <div class="space-y-4">
                            <!-- Query Field -->
                            <div>

                                <h3 class="font-medium text-gray-300 mb-2">Run Query</h3>
                                
                                <div class="bg-gray-800 rounded-lg p-4 relative">
                                    <!-- Floating Controls -->
                                    <div class="absolute top-4 right-4 flex items-center space-x-4 z-10">
                                        <div class="flex items-center space-x-1">
                                            <span class="material-symbols-outlined text-gray-400 text-sm">schedule</span>
                                            <span class="text-sm text-gray-400">1 min ago</span>
                                        </div>
                                        <button class="border border-green-600 text-green-600 hover:bg-green-600 hover:text-white px-3 h-8 rounded-md text-sm font-medium transition duration-200 flex items-center">
                                            <span class="material-symbols-outlined text-md mr-1">play_arrow</span>
                                            Run Query
                                        </button>
                                        <div class="flex items-center">
                                            <button class="bg-blue-600 text-white px-3 py-1.5 text-sm transition duration-200 rounded-l-md border-r border-gray-600">SQL</button>
                                            <button class="bg-gray-700 hover:bg-gray-600 text-gray-400 px-3 py-1.5 text-sm transition duration-200 rounded-r-md">Python</button>
                                        </div>
                                    </div>
                                    <pre class="text-sm text-gray-300 font-mono">
<code>SELECT 
    g.grid_id,
    g.longitude,
    g.latitude,
    g.area_size_km2,
    p.population_count,
    p.population_count / g.area_size_km2 as population_density
FROM grid g
JOIN population_data p ON g.grid_id = p.grid_id
WHERE g.district_name = 'Abu Dhabi Island'
    AND p.date BETWEEN '2024-04-10 00:00:00' 
    AND '2024-04-12 23:59:59'
ORDER BY population_density DESC;</code></pre>
                                </div>
                            </div>
                            
                            <!-- Database Query Results Tabs -->
                            <div class="mt-6 mb-4">
                                <div class="flex items-center">
                                    <button class="database-results-tab bg-blue-600 text-white px-3 py-1.5 text-sm transition duration-200 rounded-l-md border-r border-gray-600" data-database-results-tab="database-query-result">Query Result</button>
                                    <button class="database-results-tab bg-gray-700 hover:bg-gray-600 text-gray-400 px-3 py-1.5 text-sm transition duration-200 rounded-r-md" data-database-results-tab="database-datapoints-summary">Datapoints Summary</button>
                                </div>
                            </div>
                                
                            <!-- Database Query Result Tab Content -->
                            <div id="database-query-result-content" class="database-results-tab-content">
                                <div class="bg-gray-800 rounded-lg overflow-x-auto">
                                <table class="w-full">
                                    <thead class="border-b border-gray-700">
                                        <tr>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300 flex items-center">
                                                grid_id
                                                <span class="material-symbols-outlined text-sm ml-1 text-blue-400">arrow_upward</span>
                                            </th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">longitude</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">latitude</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">area_size_km2</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">population_count</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-300">population_density</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-700">
                                        <tr class="hover:bg-gray-700">
                                            <td class="px-4 py-2 text-sm text-gray-300">1</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">54.363716</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">24.488927</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">11.1</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">120,000</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">10,810</td>
                                        </tr>
                                        <tr class="hover:bg-gray-700">
                                            <td class="px-4 py-2 text-sm text-gray-300">2</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">54.369329</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">24.481558</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">13.4</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">145,000</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">10,821</td>
                                        </tr>
                                        <tr class="hover:bg-gray-700">
                                            <td class="px-4 py-2 text-sm text-gray-300">3</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">54.375942</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">24.474189</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">9.8</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">98,000</td>
                                            <td class="px-4 py-2 text-sm text-gray-300">10,000</td>
                                        </tr>
                                    </tbody>
                                </table>
                                </div>
                            </div>
                            
                            <!-- Database Datapoints Summary Tab Content -->
                            <div id="database-datapoints-summary-content" class="database-results-tab-content hidden">
                                <!-- Combined Data Section -->
                                <div>
                                    <div class="grid grid-cols-4 gap-4">
                                        <!-- grid_id -->
                                        <div class="bg-gray-800 rounded-lg p-4">
                                            <div class="text-sm font-medium text-white mb-2">grid_id</div>
                                            <div class="inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full mb-3">INT</div>
                                            <div class="grid grid-cols-3 gap-4 text-xs">
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Count</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Missing</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Zeroes</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Min</div>
                                                    <div class="text-gray-300">1</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Max</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Median</div>
                                                    <div class="text-gray-300">2.0</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- longitude -->
                                        <div class="bg-gray-800 rounded-lg p-4">
                                            <div class="text-sm font-medium text-white mb-2">longitude</div>
                                            <div class="inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full mb-3">FLOAT</div>
                                            <div class="grid grid-cols-3 gap-4 text-xs">
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Count</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Missing</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Zeroes</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Min</div>
                                                    <div class="text-gray-300">54.364</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Max</div>
                                                    <div class="text-gray-300">54.376</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Median</div>
                                                    <div class="text-gray-300">54.369</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- latitude -->
                                        <div class="bg-gray-800 rounded-lg p-4">
                                            <div class="text-sm font-medium text-white mb-2">latitude</div>
                                            <div class="inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full mb-3">FLOAT</div>
                                            <div class="grid grid-cols-3 gap-4 text-xs">
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Count</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Missing</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Zeroes</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Min</div>
                                                    <div class="text-gray-300">24.474</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Max</div>
                                                    <div class="text-gray-300">24.489</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Median</div>
                                                    <div class="text-gray-300">24.481</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- area_size_km2 -->
                                        <div class="bg-gray-800 rounded-lg p-4">
                                            <div class="text-sm font-medium text-white mb-2">area_size_km2</div>
                                            <div class="inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full mb-3">FLOAT</div>
                                            <div class="grid grid-cols-3 gap-4 text-xs">
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Count</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Missing</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Zeroes</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Min</div>
                                                    <div class="text-gray-300">9.8</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Max</div>
                                                    <div class="text-gray-300">13.4</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Median</div>
                                                    <div class="text-gray-300">11.1</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- population_count -->
                                        <div class="bg-gray-800 rounded-lg p-4">
                                            <div class="text-sm font-medium text-white mb-2">population_count</div>
                                            <div class="inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full mb-3">INT</div>
                                            <div class="grid grid-cols-3 gap-4 text-xs">
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Count</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Missing</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Zeroes</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Min</div>
                                                    <div class="text-gray-300">98,000</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Max</div>
                                                    <div class="text-gray-300">145,000</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Median</div>
                                                    <div class="text-gray-300">120,000</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- population_density -->
                                        <div class="bg-gray-800 rounded-lg p-4">
                                            <div class="text-sm font-medium text-white mb-2">population_density</div>
                                            <div class="inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full mb-3">FLOAT</div>
                                            <div class="grid grid-cols-3 gap-4 text-xs">
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Count</div>
                                                    <div class="text-gray-300">3</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Missing</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Zeroes</div>
                                                    <div class="text-gray-300">0.0%</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Min</div>
                                                    <div class="text-gray-300">10,000</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Max</div>
                                                    <div class="text-gray-300">10,821</div>
                                                </div>
                                                <div class="space-y-1">
                                                    <div class="text-gray-400">Median</div>
                                                    <div class="text-gray-300">10,810</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Database Connection Modal -->
    <div id="edit-database-modal" class="fixed inset-0 bg-black p-16 bg-opacity-50 flex justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1000px] flex flex-col">
            <!-- Modal Header -->
            <div class="py-4 px-6 border-b border-gray-700">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-white">Edit Database Connection</h2>
                    <button id="close-edit-database-modal" class="flex items-center text-gray-400 hover:text-white transition duration-200">
                        <span class="material-symbols-outlined text-2xl">close</span>
                    </button>
                </div>
            </div>

            <!-- Modal Content -->
            <div id="edit-database-modal-content" class="flex-1 overflow-y-auto p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Connection Name <span class="text-red-400">*</span></label>
                        <input type="text" id="edit-database-name" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter connection name" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Database Type <span class="text-red-400">*</span></label>
                        <div class="relative">
                            <select id="edit-database-type" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none" required>
                                <option value="">Select database type</option>
                                <option value="mysql">MySQL</option>
                                <option value="postgresql">PostgreSQL</option>
                                <option value="sqlserver">SQL Server</option>
                                <option value="oracle">Oracle</option>
                                <option value="sqlite">SQLite</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Host <span class="text-red-400">*</span></label>
                        <input type="text" id="edit-database-host" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter host" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Port <span class="text-red-400">*</span></label>
                        <input type="number" id="edit-database-port" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter port" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Database Name <span class="text-red-400">*</span></label>
                        <input type="text" id="edit-database-dbname" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter database name" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Username <span class="text-red-400">*</span></label>
                        <input type="text" id="edit-database-username" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter username" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Password <span class="text-red-400">*</span></label>
                        <input type="password" id="edit-database-password" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Enter password" required>
                    </div>
                </div>

                <!-- Test Results Area -->
                <div id="edit-test-results-area" class="hidden mt-6">
                    <div class="bg-gray-800 border border-gray-600 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <span class="material-symbols-outlined text-green-400 mr-2">check_circle</span>
                            <h4 class="text-white font-medium">Connection Test Results</h4>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-400">Connection Status:</span>
                                <span class="text-green-400 font-medium">✓ Successful</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Response Time:</span>
                                <span class="text-white">45ms</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Database Version:</span>
                                <span class="text-white" id="edit-db-version">MySQL 8.0.33</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Schema Access:</span>
                                <span class="text-green-400">✓ Granted</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Tables Found:</span>
                                <span class="text-white" id="edit-tables-count">12 tables</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-gray-700">
                <div class="flex items-center justify-end space-x-3">
                    <button type="button" id="cancel-edit-database" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition duration-200">
                        Cancel
                    </button>
                    <button type="button" id="confirm-edit-database" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center" onclick="handleEditConfirmButtonClick(event)">
                        Test Connection
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Collection Modal -->
    <div id="edit-collection-modal" class="fixed inset-0 p-16 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1000px] flex flex-col">
            <!-- Modal Header -->
            <div class="flex-shrink-0 border-b border-gray-700 px-6 py-4">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-white">Edit Collection</h2>
                    <button id="close-edit-collection-modal" class="text-gray-400 hover:text-white transition duration-200">
                        <span class="material-symbols-outlined text-xl">close</span>
                    </button>
                </div>
            </div>

            <!-- Modal Content -->
            <div class="flex-1 overflow-hidden flex flex-col">
                <!-- Form Section -->
                <div class="flex-shrink-0 p-6">
                    <div class="space-y-4">
                        <!-- Name Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Name <span class="text-red-500">*</span></label>
                            <input type="text" id="edit-collection-name" value="Weather Services" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        
                        <!-- Description Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Description <span class="text-red-500">*</span></label>
                            <input type="text" id="edit-collection-description" value="Real-time weather data and forecasts" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        
                        <!-- Base URL Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Base URL <span class="text-red-500">*</span></label>
                            <input type="text" id="edit-collection-base-url" value="weather.secureclient.com" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                    </div>
                </div>

                <!-- Tabs Section -->
                <div class="flex-1 flex flex-col">
                    <!-- Tab Navigation -->
                    <div class="border-b border-gray-700 px-6">
                        <nav class="flex space-x-6">
                            <button class="edit-collection-tab pb-2 px-1 border-b-2 border-red-500 text-white font-medium text-sm" data-edit-collection-tab="auth">
                                Authentication
                            </button>
                            <button class="edit-collection-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-edit-collection-tab="script">
                                Pre-Request Script
                            </button>
                            <button class="edit-collection-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-edit-collection-tab="variables">
                                Variables
                            </button>
                        </nav>
                    </div>
                    
                    <!-- Tab Content -->
                    <div class="flex-1 overflow-y-auto p-6">
                        <!-- Authentication Tab Content -->
                        <div id="edit-collection-auth-content" class="edit-collection-tab-content">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Type <span class="text-red-500">*</span></label>
                                    <div class="relative">
                                        <select required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                            <option value="none">No Authentication</option>
                                            <option value="basic">Basic Authentication</option>
                                            <option value="apikey" selected>API Key</option>
                                            <option value="bearer">Bearer Token</option>
                                            <option value="oauth2">OAuth 2.0</option>
                                        </select>
                                        <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                            <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Key <span class="text-red-500">*</span></label>
                                    <input type="text" value="X-API-Key" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Value <span class="text-red-500">*</span></label>
                                    <input type="password" value="your-api-key-here" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Add to <span class="text-red-500">*</span></label>
                                    <div class="relative">
                                        <select required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                            <option value="header" selected>Header</option>
                                            <option value="query">Query Params</option>
                                        </select>
                                        <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                            <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Pre-Request Script Tab Content -->
                        <div id="edit-collection-script-content" class="edit-collection-tab-content hidden">
                            <div class="space-y-3">
                                <textarea 
                                        class="w-full h-64 bg-gray-800 border border-gray-600 rounded-md p-4 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm font-mono resize-none"
                                        placeholder="// Access to 'llumen' object available in Llumen sandbox environment&#10;// Example:&#10;// llumen.setVariable('timestamp', Date.now());&#10;// llumen.log('Pre-request script executed');"
                                    >// Set dynamic timestamp
llumen.setVariable('timestamp', Date.now());
 
// Log execution
llumen.log('Pre-request script executed for Weather Services collection');</textarea>
                            </div>
                        </div>
                        
                        <!-- Variables Tab Content -->
                        <div id="edit-collection-variables-content" class="edit-collection-tab-content hidden">
                            <div class="space-y-2">
                                <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="0">
                                    <div class="w-9 h-8 flex items-center">
                                        <label class="toggle-switch">
                                            <input type="checkbox" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <input type="text" placeholder="Key" value="baseUrl" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <input type="text" placeholder="Value" value="https://api.weather.com/v1" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <div class="w-8 h-8 flex items-center">
                                        <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                            <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 draggable-row drop-zone" data-index="1">
                                    <div class="w-9 h-8 flex items-center">
                                        <label class="toggle-switch">
                                            <input type="checkbox" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <input type="text" placeholder="Key" value="apiKey" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <input type="text" placeholder="Value" value="{{apiKey}}" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <div class="w-8 h-8 flex items-center">
                                        <button class="text-red-400 hover:text-red-300 p-1 flex items-center">
                                            <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 non-draggable" data-index="2">
                                    <div class="drag-handle w-6 h-8 flex items-center">
                                        <span class="material-symbols-outlined hidden" style="font-size: 20px;">drag_indicator</span>
                                    </div>
                                    <div class="w-9 h-8 flex items-center">
                                        <label class="toggle-switch hidden">
                                            <input type="checkbox" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <div class="w-8 h-8 flex items-center">
                                        <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                            <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="flex-shrink-0 border-t border-gray-700 px-6 py-4">
                    <div class="flex justify-end space-x-3">
                        <button id="cancel-edit-collection" class="px-4 py-2 text-gray-400 hover:text-white transition duration-200">
                            Cancel
                        </button>
                        <button id="save-edit-collection" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Request Modal -->
    <div id="edit-request-modal" class="fixed inset-0 p-16 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1000px] flex flex-col">
            <!-- Modal Header -->
            <div class="flex-shrink-0 border-b border-gray-700 px-6 py-4">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-white">Edit Request</h2>
                    <button id="close-edit-request-modal" class="text-gray-400 hover:text-white transition duration-200">
                        <span class="material-symbols-outlined text-xl">close</span>
                    </button>
                </div>
            </div>

            <!-- Modal Content -->
            <div class="flex-1 overflow-hidden flex flex-col">
                <!-- Collection Info Section -->
                <div class="flex-shrink-0 p-6 border-b border-gray-700">
                    <div class="flex items-center text-sm text-gray-400">
                        <span class="material-symbols-outlined mr-2" style="font-size: 16px;">folder</span>
                        <span>Collection:</span>
                        <span class="ml-1 text-gray-300 font-medium">Weather Services</span>
                    </div>
                </div>
                
                <!-- Form Section -->
                <div class="flex-1 overflow-y-auto p-6">
                    <div class="space-y-4">
                        <!-- Name Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Name <span class="text-red-500">*</span></label>
                            <input type="text" id="edit-request-name" value="Get Current Weather" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        
                        <!-- Description Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Description <span class="text-red-500">*</span></label>
                            <input type="text" id="edit-request-description" value="Retrieve current weather conditions" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        
                        <!-- Method Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Method <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <select id="edit-request-method" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                    <option value="GET" selected>GET</option>
                                    <option value="POST">POST</option>
                                    <option value="PUT">PUT</option>
                                    <option value="PATCH">PATCH</option>
                                    <option value="DELETE">DELETE</option>
                                </select>
                                <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                    <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Endpoint Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Endpoint <span class="text-red-500">*</span></label>
                            <input type="text" id="edit-request-endpoint" value="/weather/current" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="flex-shrink-0 border-t border-gray-700 px-6 py-4">
                    <div class="flex justify-end space-x-3">
                        <button id="cancel-edit-request" class="px-4 py-2 text-gray-400 hover:text-white transition duration-200">
                            Cancel
                        </button>
                        <button id="save-edit-request" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Request Modal -->
    <div id="create-request-modal" class="fixed inset-0 p-16 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1000px] flex flex-col">
            <!-- Modal Header -->
            <div class="flex-shrink-0 border-b border-gray-700 px-6 py-4">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-white">Add Request</h2>
                    <button id="close-create-request-modal" class="text-gray-400 hover:text-white transition duration-200">
                        <span class="material-symbols-outlined text-xl">close</span>
                    </button>
                </div>
            </div>

            <!-- Modal Content -->
            <div class="flex-1 overflow-hidden flex flex-col">
                <!-- Collection Info Section -->
                <div class="flex-shrink-0 p-6 border-b border-gray-700">
                    <div class="flex items-center text-sm text-gray-400">
                        <span class="material-symbols-outlined mr-2" style="font-size: 16px;">folder</span>
                        <span>Collection:</span>
                        <span class="ml-1 text-gray-300 font-medium">Weather Services</span>
                    </div>
                </div>
                
                <!-- Form Section -->
                <div class="flex-1 overflow-y-auto p-6">
                    <div class="space-y-4">
                        <!-- Name Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Name <span class="text-red-500">*</span></label>
                            <input type="text" id="create-request-name" placeholder="Enter request name" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        
                        <!-- Description Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Description <span class="text-red-500">*</span></label>
                            <input type="text" id="create-request-description" placeholder="Enter request description" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        
                        <!-- Method Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Method <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <select id="create-request-method" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                    <option value="">Select method</option>
                                    <option value="GET">GET</option>
                                    <option value="POST">POST</option>
                                    <option value="PUT">PUT</option>
                                    <option value="PATCH">PATCH</option>
                                    <option value="DELETE">DELETE</option>
                                </select>
                                <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                    <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Endpoint Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Endpoint <span class="text-red-500">*</span></label>
                            <input type="text" id="create-request-endpoint" placeholder="Enter endpoint" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="flex-shrink-0 border-t border-gray-700 px-6 py-4">
                    <div class="flex justify-end space-x-3">
                        <button id="cancel-create-request" class="px-4 py-2 text-gray-400 hover:text-white transition duration-200">
                            Cancel
                        </button>
                        <button id="save-create-request" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center">
                            Add Request
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Collection Modal -->
    <div id="create-collection-modal" class="fixed inset-0 p-16 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl w-11/12 h-full max-w-[1000px] flex flex-col">
            <!-- Modal Header -->
            <div class="flex-shrink-0 border-b border-gray-700 px-6 py-4">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-white">Create Collection</h2>
                    <button id="close-create-collection-modal" class="text-gray-400 hover:text-white transition duration-200">
                        <span class="material-symbols-outlined text-xl">close</span>
                    </button>
                </div>
            </div>
            <!-- Modal Content -->
            <div class="flex-1 overflow-hidden flex flex-col">
                <!-- Form Section (stacked) -->
                <div class="flex-shrink-0 p-6">
                    <div class="space-y-4">
                        <!-- Name Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Name <span class="text-red-500">*</span></label>
                            <input type="text" id="create-collection-name" placeholder="Enter collection name" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        <!-- Description Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Description <span class="text-red-500">*</span></label>
                            <input type="text" id="create-collection-description" placeholder="Enter collection description" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                        <!-- Base URL Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Base URL <span class="text-red-500">*</span></label>
                            <input type="text" id="create-collection-base-url" placeholder="Enter base URL" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                        </div>
                    </div>
                </div>
                <!-- Tabs Section -->
                <div class="flex-1 flex flex-col">
                    <!-- Tab Navigation -->
                    <div class="border-b border-gray-700 px-6">
                        <nav class="flex space-x-6">
                            <button class="create-collection-tab pb-2 px-1 border-b-2 border-red-500 text-white font-medium text-sm" data-create-collection-tab="auth">Authentication</button>
                            <button class="create-collection-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-create-collection-tab="script">Pre-Request Script</button>
                            <button class="create-collection-tab pb-2 px-1 border-b-2 border-transparent text-gray-400 hover:text-white font-medium text-sm" data-create-collection-tab="variables">Variables</button>
                        </nav>
                    </div>
                    <!-- Tab Content -->
                    <div class="flex-1 overflow-y-auto p-6">
                        <!-- Authentication Tab Content -->
                        <div id="create-collection-auth-content" class="create-collection-tab-content">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Type <span class="text-red-500">*</span></label>
                                    <div class="relative">
                                        <select required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                            <option value="">Select authentication type</option>
                                            <option value="none">No Authentication</option>
                                            <option value="basic">Basic Authentication</option>
                                            <option value="apikey">API Key</option>
                                            <option value="bearer">Bearer Token</option>
                                            <option value="oauth2">OAuth 2.0</option>
                                        </select>
                                        <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                            <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Key <span class="text-red-500">*</span></label>
                                    <input type="text" placeholder="Enter key" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Value <span class="text-red-500">*</span></label>
                                    <input type="password" placeholder="Enter value" required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Add to <span class="text-red-500">*</span></label>
                                    <div class="relative">
                                        <select required class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500 appearance-none">
                                            <option value="">Select location</option>
                                            <option value="header">Header</option>
                                            <option value="query">Query Params</option>
                                        </select>
                                        <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                            <span class="material-symbols-outlined text-gray-400 text-md">expand_more</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Pre-Request Script Tab Content -->
                        <div id="create-collection-script-content" class="create-collection-tab-content hidden">
                            <div class="space-y-3">
                                <textarea 
                                    class="w-full h-64 bg-gray-800 border border-gray-600 rounded-md p-4 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm font-mono resize-none"
                                    placeholder="// Access to 'llumen' object available in Llumen sandbox environment&#10;// Example:&#10;// llumen.setVariable('timestamp', Date.now());&#10;// llumen.log('Pre-request script executed');"
                                ></textarea>
                            </div>
                        </div>
                        <!-- Variables Tab Content -->
                        <div id="create-collection-variables-content" class="create-collection-tab-content hidden">
                            <div class="space-y-2">
                                <div class="flex items-center space-x-2 non-draggable" data-index="0">
                                    <div class="drag-handle w-6 h-8 flex items-center">
                                        <span class="material-symbols-outlined hidden" style="font-size: 20px;">drag_indicator</span>
                                    </div>
                                    <div class="w-9 h-8 flex items-center pointer-events-none opacity-30">
                                        <label class="toggle-switch">
                                            <input type="checkbox">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <input type="text" placeholder="Key" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <input type="text" placeholder="Value" value="" class="flex-1 bg-gray-800 border border-gray-600 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <div class="w-8 h-8 flex items-center">
                                        <button class="text-red-400 hover:text-red-300 p-1 flex items-center hidden">
                                            <span class="material-symbols-outlined" style="font-size: 20px;">delete</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Footer -->
                <div class="flex-shrink-0 border-t border-gray-700 px-6 py-4">
                    <div class="flex justify-end space-x-3">
                        <button id="cancel-create-collection" class="px-4 py-2 text-gray-400 hover:text-white transition duration-200">
                            Cancel
                        </button>
                        <button id="save-create-collection" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center">
                            Create Collection
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
</html> 